<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/me417/libs/katex/katex.min.css"> <link rel=stylesheet  href="/me417/libs/highlight/github.min.css"> <link rel=stylesheet  href="/me417/css/franklin.css"> <link rel=stylesheet  href="/me417/css/poole_hyde.css"> <link rel=stylesheet  href="/me417/css/custom.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 968px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/me417/assets/c.svg"> <title>Numerical Lesson #4 - MATLAB</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <br> <img src="/me417/assets/KuwaitUniversityLogoTextLight.svg" style="width: 200px; height: auto; display: inline"> <h1 style="font-size:2em; opacity: 0.75;"><a href="/me417/">ME 417</a></h1> <p class=lead >Control of Mechanical Systems</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/me417/">Home</a> <a class="sidebar-nav-item active" href="/me417/numerical_lessons/">Numerical Lessons</a> <a class="sidebar-nav-item " href="/me417/numerical_assignments/">Numerical Assignments</a> <a class="sidebar-nav-item " href="/me417/homeworks/">Homeworks</a> <br> <small style="text-transform: uppercase; font-size: 0.75em">Class Lectures</small> <div class=part >Part I</div> <a class="sidebar-nav-item " href="/me417/part_i/lecture1/"><b>Lecture 1</b> - <em>Introduction</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture2/"><b>Lecture 2</b> - <em>Analysis and Design</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture3/"><b>Lecture 3</b> - <em>Transfer Function</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture4/"><b>Lecture 4</b> - <em>Mechanical Systems</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture5/"><b>Lecture 5</b> - <em>Electromechanical Systems</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture6/"><b>Lecture 6</b> - <em>Poles Zeros and System Response</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture7/"><b>Lecture 7</b> - <em>The General Second-Order System</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture8/"><b>Lecture 8</b> - <em>Introduction to Stability and Feedback Control</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture9/"><b>Lecture 9</b> - <em>PID Control via Gain Tuning</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture10/"><b>Lecture 10</b> - <em>Steady-State Error</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture11/"><b>Lecture 11</b> - <em>Unity Feedback Controller Design</em></a> <div class=part >Part II</div> <a class="sidebar-nav-item " href="/me417/part_ii/lecture1/"><b>Lecture 1</b> - <em>Introduction to Root-Locus</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture2/"><b>Lecture 2</b> - <em>Sketching the Root-Locus</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture3/"><b>Lecture 3</b> - <em>Transient Response Design via Gain Adjustment</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture4/"><b>Lecture 4</b> - <em>Improving Steady-State Response</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture5/"><b>Lecture 5</b> - <em>Improving Transient Response</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture6/"><b>Lecture 6</b> - <em>Improving Overall Response</em></a> <div class=part >Part III</div> <a class="sidebar-nav-item " href="/me417/part_iii/lecture1/"><b>Lecture 1</b> - <em>State-Space Representation</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture2/"><b>Lecture 2</b> - <em>Stability and Steady-State Error in State-Space</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture3/"><b>Lecture 3</b> - <em>State-Space Controller Representation and Design</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture4/"><b>Lecture 4</b> - <em>Introduction to Linear Optimal Control</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture5/"><b>Lecture 5</b> - <em>State-Space Controller Design Problems</em></a> <div class=part >Part IV</div> <a class="sidebar-nav-item " href="/me417/part_iv/lecture1/"><b>Lecture 1</b> - <em>Introduction to Frequency Response</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture2/"><b>Lecture 2</b> - <em>Sketching Bode Plots</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture3/"><b>Lecture 3</b> - <em>Refining Second Order Systems Bode Plots</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture4/"><b>Lecture 4</b> - <em>System Identification from Frequnecy Response</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture5/"><b>Lecture 5</b> - <em>Stability in Frequency Response</em></a> </nav> <p>&copy; Ali AlSaibie, PhD.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=span_stylecolorgreenme_417_control_of_mechanical_systems ><a href="#span_stylecolorgreenme_417_control_of_mechanical_systems"> <span style='color:green'>ME 417 Control of Mechanical Systems</span></a></h1> <p><a href="/me417/numerical_lessons/index.html">Back to Lessons</a></p> <h3 id=numerical_lesson_4 ><a href="#numerical_lesson_4">Numerical Lesson #4</a></h3> <h2 id=part_i_from_s-plane_pid_controller_design_to_digital_implementation ><a href="#part_i_from_s-plane_pid_controller_design_to_digital_implementation">PART I: FROM S-PLANE PID CONTROLLER DESIGN TO DIGITAL IMPLEMENTATION</a></h2> <h3 id=disk_drive_system ><a href="#disk_drive_system">Disk Drive System</a></h3> <p>For the disk drive system shown on Figure 1. In Lesson 2, you&#39;ve simulated the response to the system using numerical integration and applied a PID controller digitally then tuned it manually. In assignment 3, you&#39;ve learned how to design the PID controller analytically using the root-locus method. In this lesson, you will take the PID controller you designed in lesson 3 and implement it into the simulation you developed in lesson 2. This is analogous to integrating your controller into a real system.</p> <p>The catch here, is that the gains <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_{p}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">K_{I}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">K_{D}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> achieved via root-locus are the continuous domain PID gains, while the gains you implement in the numerical integration method have to be the equivalent discrete gains. In order to convert between the continuous domain PID controller to discrete domain PID controller, you need to use the following discrete PID form:</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo>=</mo><mi>u</mi><mo stretchy=false >[</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mi>a</mi><mi>e</mi><mo stretchy=false >[</mo><mi>k</mi><mo>+</mo><mi>b</mi><mi>e</mi><mrow><mo fence=true >[</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo fence=true >]</mo></mrow><mo>+</mo><mi>c</mi><mi>e</mi><mo stretchy=false >[</mo><mi>k</mi><mo>−</mo><mn>2</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">u[k]= u[k - 1] + ae[k + be\left\lbrack k - 1 \right\rbrack + ce\lbrack k - 2\rbrack</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">e</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">e</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mclose >]</span></span></span></span> </p> <p>Where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mrow><mo fence=true >(</mo><msub><mi>K</mi><mi>P</mi></msub><mo>+</mo><msub><mi>K</mi><mi>I</mi></msub><mfrac><msub><mi>T</mi><mi>s</mi></msub><mn>2</mn></mfrac><mo>+</mo><mfrac><msub><mi>K</mi><mi>D</mi></msub><msub><mi>T</mi><mi>s</mi></msub></mfrac><mo fence=true >)</mo></mrow><mo separator=true >,</mo><mi>b</mi><mo>=</mo><mrow><mo fence=true >(</mo><mo>−</mo><msub><mi>K</mi><mi>p</mi></msub><mo>+</mo><msub><mi>K</mi><mi>I</mi></msub><mfrac><msub><mi>T</mi><mi>s</mi></msub><mn>2</mn></mfrac><mo>−</mo><mfrac><mrow><mn>2</mn><msub><mi>K</mi><mi>D</mi></msub></mrow><msub><mi>T</mi><mi>s</mi></msub></mfrac><mo fence=true >)</mo></mrow><mo separator=true >,</mo><mi>c</mi><mo>=</mo><mfrac><msub><mi>K</mi><mi>D</mi></msub><msub><mi>T</mi><mi>s</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">a = \left( K_{P} + K_{I}\frac{T_{s}}{2} + \frac{K_{D}}{T_{s}} \right),b = \left( - K_{p} + K_{I}\frac{T_{s}}{2} - \frac{2K_{D}}{T_{s}} \right),c = \frac{K_{D}}{T_{s}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.80002em;vertical-align:-0.65002em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8886359999999999em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.410305em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.80002em;vertical-align:-0.65002em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8886359999999999em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.410305em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.3337359999999998em;vertical-align:-0.44509999999999994em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8886359999999999em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.410305em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>,</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">T_{s}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the sampling time &#40;the integration time step, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>dt</mtext></mrow><annotation encoding="application/x-tex">\text{dt}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class=mord >dt</span></span></span></span></span>, in your numerical integration&#41;. The gains <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub><mo separator=true >,</mo><msub><mi>K</mi><mi>I</mi></msub><mo separator=true >,</mo><msub><mi>K</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">K_{p},K_{I},K_{D}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are the gains retrieved from the PID controller design in the s-domain &#40;root locus&#41;. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mo fence=true >[</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">u\left\lbrack k - 1 \right\rbrack</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span> denotes the previous controller output value,<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">e\lbrack k\rbrack</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span></span></span></span> is the current error, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy=false >[</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">e\lbrack k - 1\rbrack</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span> is the previous error, etc.</p> <p>Note that, with the discrete controller, we don&#39;t integrate or differentiate the error, instead the discrete implementation uses a &quot;difference equation&quot;, the integration/differentiation is done implicitly through the gains <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo separator=true >,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a,b,c</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span></span></span></span></p> <center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/media/DiskDrive.svg" style="max-width:600px"></center> <p><strong> <center>Figure 1 - Disk Drive System</center></strong></p> <h3 id=ia_collocated_control ><a href="#ia_collocated_control">I.A Collocated Control</a></h3> <p><strong> <span style='color:green'>EXERCISE 1</span></strong></p> <p>From the PID gains&#39; values you retrieved in controlling the motor, &#40;Lesson 3 II.C Collocated Control&#41;, implement them in a numerical integration simulation of the closed-loop system with PID &#40;which you&#39;ve completed in lesson 2&#41;, while scaling them properly using the difference equation for the control law, in order to control the motor position. Compare your results in the numerical integration simulation with the simulation of the closed-loop response in lesson 3.</p> <ul> <li><p>Plot the controller output u&#40;t&#41;, the motor position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\theta_{m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and head position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">\theta_{h}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p> </ul> <pre><code class="matlab hljs">clear all; 
<span class=hljs-comment >% Model Parameters</span>
I_m_=<span class=hljs-number >0.1</span>; I_h_=<span class=hljs-number >0.04</span>; K_=<span class=hljs-number >0.07</span>; b_=<span class=hljs-number >0.1</span>;
<span class=hljs-comment >% Model in Impedance Method</span>
syms K b I_m I_h Mm s;
A = [I_m*s^<span class=hljs-number >2</span>+b*s+K, -b*s-K;
    -b*s-K, I_h*s^<span class=hljs-number >2</span>+b*s+K];
B=[<span class=hljs-number >1</span>;<span class=hljs-number >0</span>];

<span class=hljs-comment >% Retrieve the transfer functions from the model</span>
G_symbolic = inv(A)*B;
Gm_s = subs(G_symbolic(<span class=hljs-number >1</span>), {K I_m I_h b}, {K_ I_m_ I_h_ b_});
Gh_s = subs(G_symbolic(<span class=hljs-number >2</span>), {K I_m I_h b}, {K_ I_m_ I_h_ b_});
[num,den] = numden(Gm_s);
num = sym2poly(num);
den = sym2poly(den);
Gm = tf(num,den);
[num,den] = numden(Gh_s);
num = sym2poly(num);
den = sym2poly(den);
Gh = tf(num,den);</code></pre> <pre><code class="matlab hljs"><span class=hljs-comment >% Simulate using step()</span>
dt = <span class=hljs-number >0.001</span>;
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >5</span>;
Kp = <span class=hljs-number >3.079</span>*<span class=hljs-number >0.22489</span>; Ki = <span class=hljs-number >0</span>; Kd = <span class=hljs-number >0.22489</span>;
Gpid = pid(Kp, Ki, Kd);
Gcl = feedback(Gpid*Gm, <span class=hljs-number >1</span>);

<span class=hljs-comment >% Simulate Using Numerical Integration</span>
dxdt = @(t,x,u) [
    x(<span class=hljs-number >2</span>); 
    (u - K_ * x(<span class=hljs-number >1</span>) - b_ * x(<span class=hljs-number >2</span>) + K_ * x(<span class=hljs-number >3</span>) + b_ * x(<span class=hljs-number >4</span>)) / I_m_; 
    x(<span class=hljs-number >4</span>);
    (-K_ * x(<span class=hljs-number >3</span>) - b_ * x(<span class=hljs-number >4</span>) + K_ * x(<span class=hljs-number >1</span>) + b_ * x(<span class=hljs-number >2</span>)) / I_h_ 
    ]; 

<span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
x(:,<span class=hljs-number >1</span>) = x0;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 1</span>
r = <span class=hljs-number >1</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)
    e(<span class=hljs-number >1</span>, idx)   = r - x(<span class=hljs-number >1</span>,idx);
    <span class=hljs-keyword >if</span> idx &gt; <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Kc*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-2</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >1</span>
        u(<span class=hljs-number >1</span>,idx) = Ka*e(<span class=hljs-number >1</span>,idx); 
    <span class=hljs-keyword >end</span>
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
[xstep, tstep] = step(Gcl, t);
<span class=hljs-built_in >plot</span>(tstep,xstep, <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >2</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >3</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Step&quot;</span>, <span class=hljs-string >&quot;Numerical Integration&quot;</span>])
grid on</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_3_1.png" alt=""> <h3 id=ib_non-collocated_control ><a href="#ib_non-collocated_control">I.B Non-Collocated Control</a></h3> <p><strong> <span style='color:green'>EXERCISE 2</span></strong></p> <p>Repeat the process in I.A, but this time for the non-collocated control problem.</p> <ul> <li><p>Note that the error is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>r</mi><mo>−</mo><msub><mi>θ</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">e = r - \theta_{h}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p> <li><p>Plot the controller output u&#40;t&#41;, the motor position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\theta_{m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and head position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">\theta_{h}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p> </ul> <pre><code class="matlab hljs"><span class=hljs-comment >% Simulate using step()</span>
dt = <span class=hljs-number >0.01</span>;
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >5</span>;
Kp = <span class=hljs-number >0.25</span>; Ki = <span class=hljs-number >0</span>; Kd = <span class=hljs-number >0.8</span>;
Gpid = pid(Kp, Ki, Kd);
Gcl = feedback(Gpid*Gh, <span class=hljs-number >1</span>); <span class=hljs-comment >% Feedback around head not motor</span>

<span class=hljs-comment >% Simulate Using Numerical Integration</span>
dxdt = @(t,x,u) [
    x(<span class=hljs-number >2</span>); 
    (u - K_ * x(<span class=hljs-number >1</span>) - b_ * x(<span class=hljs-number >2</span>) + K_ * x(<span class=hljs-number >3</span>) + b_ * x(<span class=hljs-number >4</span>)) / I_m_; 
    x(<span class=hljs-number >4</span>);
    (-K_ * x(<span class=hljs-number >3</span>) - b_ * x(<span class=hljs-number >4</span>) + K_ * x(<span class=hljs-number >1</span>) + b_ * x(<span class=hljs-number >2</span>)) / I_h_ 
    ]; 

<span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
x(:,<span class=hljs-number >1</span>) = x0;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 1</span>
r = <span class=hljs-number >1</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)
    e(<span class=hljs-number >1</span>, idx)   = r - x(<span class=hljs-number >3</span>,idx); <span class=hljs-comment >% Change output being fed-back, everything else remains the same</span>
    <span class=hljs-keyword >if</span> idx &gt; <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Kc*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-2</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >1</span>
        u(<span class=hljs-number >1</span>,idx) = Ka*e(<span class=hljs-number >1</span>,idx); 
    <span class=hljs-keyword >end</span>
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
[xstep, tstep] = step(Gcl, t);
<span class=hljs-built_in >plot</span>(tstep,xstep, <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >2</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >3</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Step&quot;</span>, <span class=hljs-string >&quot;Numerical Integration&quot;</span>])
grid on</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_5_1.png" alt=""> <p>In this example, the numerical integration differs from the continous domain solution, can you guess <em>why</em>? Decrease <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dt</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span> and retry.</p> <h2 id=part_ii_multiple_output_controller_design_for_a_stable_nonlinear_system ><a href="#part_ii_multiple_output_controller_design_for_a_stable_nonlinear_system">PART II: MULTIPLE OUTPUT CONTROLLER DESIGN FOR A STABLE NONLINEAR SYSTEM</a></h2> <h3 id=bridge_crane_system ><a href="#bridge_crane_system">Bridge Crane System</a></h3> <p>A bridge crane is modeled as a cart suspended on a rail with a pendulum connected to the cart, as shown on Figure 2.</p> <p> <table style="width:100%"> <tr> <th><center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/media/Hanging_Crane.svg" style="max-width:300px"></center> <th><center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/media/Crane.svg" style="max-width:300px"></center> </table> <strong> <center>Figure 2 - Hanging Crane</center></strong></p> <p>The equations of motion for the crane model above is given by the following</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>c</mi></msub><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mo fence=true >)</mo></mrow><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo>+</mo><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>−</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mi>g</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mo>−</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mtext>cosθ</mtext></mrow><annotation encoding="application/x-tex"> \left( m_{c} + m_{r} \right)\ddot{x} + b\dot{x} + m_{r}l\ddot{\theta}cos\theta - m_{r}l{\dot{\theta}}^{2}sin\theta = f(t) \left( I + m_{r}l^{2} \right)\ddot{\theta} + m_{r}glsin\theta = - m_{r}l\ddot{x}\text{cosθ} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0813em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.285308em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.28131em;vertical-align:-0.35001em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class="mord text"><span class=mord >cosθ</span></span></span></span></span></span> <p>After algebraic manipulation to remove the coupling of second derivates, we get</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.24999999999999992em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >(</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>c</mi></msub><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mo fence=true >)</mo></mrow><mo>−</mo><msubsup><mi>m</mi><mi>r</mi><mn>2</mn></msubsup><msup><mi>l</mi><mn>2</mn></msup><msup><mo><mi>cos</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>θ</mi><mo fence=true >)</mo></mrow><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo>−</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>−</mo><msubsup><mi>m</mi><mi>r</mi><mn>2</mn></msubsup><msup><mi>l</mi><mn>2</mn></msup><mi>g</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>+</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>=</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >(</mo><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>r</mi></msub><mo>+</mo><msub><mi>m</mi><mi>c</mi></msub><mo fence=true >)</mo></mrow><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mo>−</mo><msubsup><mi>m</mi><mi>r</mi><mn>2</mn></msubsup><msup><mi>l</mi><mn>2</mn></msup><msup><mo><mi>cos</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>θ</mi><mo fence=true >)</mo></mrow><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mo>−</mo><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mtext>lcosθ</mtext><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mo>+</mo><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>r</mi></msub><mo>+</mo><msub><mi>m</mi><mi>c</mi></msub><mo fence=true >)</mo></mrow><msub><mi>m</mi><mi>r</mi></msub><mi>g</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mo>−</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \left( \left( I + m_{r}l^{2} \right)\left( m_{c} + m_{r} \right) - m_{r}^{2}l^{2}\cos^{2}\theta \right)\ddot{x} - \left( I + m_{r}l^{2} \right)m_{r}l{\dot{\theta}}^{2}cos\theta - m_{r}^{2}l^{2}gcos\theta sin\theta + \left( I + m_{r}l^{2} \right)b\dot{x} = \left( I + m_{r}l^{2} \right)f(t) \\ \left( \left( m_{r} + m_{c} \right)\left( I + m_{r}l^{2} \right) - m_{r}^{2}l^{2}\cos^{2}\theta \right)\ddot{\theta} - b\dot{x} + m_{r}\text{lcosθ}{\dot{\theta}}^{2} + \left( m_{r} + m_{c} \right)m_{r}glsin\theta = - m_{r}lcos\theta f(t) \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.5906160000000003em;vertical-align:-1.545308em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.0453080000000003em;"><span style="top:-4.045308em;"><span class=pstrut  style="height:3.135308em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class=mop >cos</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span><span style="top:-2.2500000000000004em;"><span class=pstrut  style="height:3.135308em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class=mop >cos</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class=mord >lcosθ</span></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.545308em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>Where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> is the coefficient of friction between the wheels and the track, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">m_{r}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">m_{c}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are the rod and cart mass respectively, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> is the rod&#39;s moment of inertia about its center of mass, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> is the distance from the pivot to the center of mass of the rod and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> is the gravity constant. Note that the above equations are nonlinear due to the presence of the trigonometric terms <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo separator=true >,</mo><mtext> </mtext><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">sin\theta,\, cos\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> and the square term <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">{\dot{\theta}}^{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.135308em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>.</p> <p>Given the following parameters:</p> <table><tr><th align=right >Parameter<th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">m_{c}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">m_{r}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span><tr><td align=right >Value<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi>k</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">10kg</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mord >0</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>k</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">2kg</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.11</mn><mi>k</mi><mi>g</mi><mo>⋅</mo><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">0.11kg \cdot m^{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >1</span><span class=mord >1</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>40</mn><mi>c</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">40cm</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >4</span><span class=mord >0</span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn><mi>N</mi><mo>−</mo><mtext>/</mtext><mi>m</mi></mrow><annotation encoding="application/x-tex">20N - \text{/}m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class=mord >2</span><span class=mord >0</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class=mord >/</span></span><span class="mord mathnormal">m</span></span></span></span></table> <h3 id=iia_linearizing_modeling_in_state-space_form_and_converting_to_transfer_function ><a href="#iia_linearizing_modeling_in_state-space_form_and_converting_to_transfer_function">II.A Linearizing, Modeling in State-Space Form and Converting to Transfer Function</a></h3> <p><strong> <span style='color:green'>EXERCISE 3</span></strong></p> <p>Linearize the crane model above from equations above and construct the state-space representation of the system. Provide your answer within the MATLAB script. Construct your output vector as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>θ</mi></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">y = \begin{bmatrix} x \\ \theta \\ \end{bmatrix} = \begin{bmatrix} x_{1} \\ x_{3} \\ \end{bmatrix}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p> <ul> <li><p>To linearize: assume the following approximations: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>≈</mo><mi>θ</mi><mo separator=true >,</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>≈</mo><mn>1</mn><mo separator=true >,</mo><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mo>≈</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sin\theta \approx \theta,cos\theta \approx 1,{\dot{\theta}}^{2} \approx 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.329748em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></p> </ul> <pre><code class="matlab hljs">clear all;
mr = <span class=hljs-number >2</span>; mc = <span class=hljs-number >10</span>; I = <span class=hljs-number >0.106</span>; b = <span class=hljs-number >20</span>; l = <span class=hljs-number >.4</span>; g = <span class=hljs-number >9.81</span>;

Den = ((I + mr*l^<span class=hljs-number >2</span>) * (mc + mr) - mr^<span class=hljs-number >2</span> * l^<span class=hljs-number >2</span>);

A = [
    <span class=hljs-number >0</span>, <span class=hljs-number >1</span>, <span class=hljs-number >0</span>, <span class=hljs-number >0</span>;
    <span class=hljs-number >0</span>, -(I + mr*l^<span class=hljs-number >2</span>)*b/Den, +mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g/Den, <span class=hljs-number >0</span>; 
    <span class=hljs-number >0</span>, <span class=hljs-number >0</span>, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>;
    <span class=hljs-number >0</span>, b/Den, -(mr + mc)*mr*g*l, <span class=hljs-number >0</span>
    ];
B = [<span class=hljs-number >0</span>; (I + mr*l^<span class=hljs-number >2</span>)/Den; <span class=hljs-number >0</span>; -mr*l/Den];
C = [<span class=hljs-number >1</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span>; <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >1</span> <span class=hljs-number >0</span>];
D = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>];</code></pre> <p><strong> <span style='color:green'>EXERCISE 4</span></strong></p> <p>Using the state-space model, derive the transfer functions relating the input <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> to cart position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>1</mn></msub><mrow><mo fence=true >(</mo><mi>s</mi><mo fence=true >)</mo></mrow><mo>=</mo><mfrac><mrow><mi>X</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><mrow><mi>F</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">G_{1}\left( s \right) = \frac{X(s)}{F(s)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">s</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.53em;vertical-align:-0.52em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.01em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, and input <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> to payload angle <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\theta(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>2</mn></msub><mrow><mo fence=true >(</mo><mi>s</mi><mo fence=true >)</mo></mrow><mo>=</mo><mfrac><mrow><mi mathvariant=normal >Θ</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><mrow><mi>F</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">G_{2}\left( s \right) = \frac{\Theta(s)}{F(s)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">s</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.53em;vertical-align:-0.52em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.01em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Θ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p> <ul> <li><p>You can use the MATLAB built-in function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mn>2</mn><mi>f</mi><mi>t</mi><mo stretchy=false >(</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">ss2ft()</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class=mopen >(</span><span class=mclose >)</span></span></span></span>, or</p> <li><p>Use <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo><mrow><mo>=</mo><mi mathvariant=bold >C</mi></mrow><mfrac><mrow><mi>a</mi><mi>d</mi><mi>j</mi><mo stretchy=false >(</mo><mi>s</mi><mi mathvariant=bold >I</mi><mo>−</mo><mi mathvariant=bold >A</mi><mo stretchy=false >)</mo></mrow><mrow><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy=false >(</mo><mi>s</mi><mi mathvariant=bold >I</mi><mo>−</mo><mi mathvariant=bold >A</mi><mo stretchy=false >)</mo></mrow></mfrac><mi mathvariant=bold >B</mi></mrow><annotation encoding="application/x-tex">G(s)\mathbf{= C}\frac{adj(s\mathbf{I} - \mathbf{A})}{det(s\mathbf{I} - \mathbf{A})}\mathbf{B}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord mathnormal">G</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span><span class=mord ><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathbf">C</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.01em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mord mtight"><span class="mord mathbf mtight">I</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathbf mtight">A</span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mord mtight"><span class="mord mathbf mtight">I</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathbf mtight">A</span></span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathbf">B</span></span></span></span></span></p> </ul> <blockquote> <p>Note that since <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msup><mrow><mo>∈</mo><mi mathvariant=script >R</mi></mrow><mrow><mn>2</mn><mo>×</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">C\mathcal{\in R}^{2 \times 1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.926438em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mord ><span class=mord ><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathcal">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.887338em;"><span style="top:-3.1362300000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>, there would be two transfer functions corresponding to the two outputs.</p> </blockquote> <pre><code class="matlab hljs">[num,den] = ss2tf(A,B,C,D);
Gcart = tf(num(<span class=hljs-number >1</span>,:),den)
Gpendulum = tf(num(<span class=hljs-number >2</span>,:),den)</code></pre> <pre><code class="plaintext hljs">Gcart =
     
               0.09526 s^2 + 8.72
      -------------------------------------
      s^4 + 1.905 s^3 + 94.18 s^2 + 173.1 s
    
    Continuous-time transfer function.    
    
Gpendulum =   
       -0.1789 s^2 + 0.08521 s - 1.495e-15
      -------------------------------------
      s^4 + 1.905 s^3 + 94.18 s^2 + 173.1 s

    Continuous-time transfer function.</code></pre> <h3 id=iib_cart-only_position_control_and_disturbance_rejection_via_pid_control ><a href="#iib_cart-only_position_control_and_disturbance_rejection_via_pid_control">II.B Cart-Only Position Control and Disturbance Rejection via PID Control</a></h3> <p><strong><span style='color:green'>EXERCISE 5</span></strong></p> <p>Given the transfer function relating the input to cart position, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>1</mn></msub><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">G_{1}(s)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span></span>, design a controller to control the cart position.</p> <p>Implement your designed controller in the crane simulation provided for a step input <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo fence=true >(</mo><mi>t</mi><mo fence=true >)</mo></mrow><mo>=</mo><mn>4</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">r\left( t \right) = 4m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">t</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >4</span><span class="mord mathnormal">m</span></span></span></span></p> <p>Plot the position variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">x,\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> in one subplot, the velocity variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{x},\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> in another subplot, and the output <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">u(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> in the third subplot.</p> <pre><code class="matlab hljs"><span class=hljs-comment >%CRANE </span>

<span class=hljs-comment >% Simulate using step()</span>
dt = <span class=hljs-number >0.0001</span>;
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >10</span>;
Kp = <span class=hljs-number >200</span>; Ki = <span class=hljs-number >50</span>; Kd = <span class=hljs-number >100</span>;
Gpid = pid(Kp, Ki, Kd);
Gcl = feedback(Gpid*Gcart, <span class=hljs-number >1</span>); <span class=hljs-comment >% Feedback around head not motor</span>

<span class=hljs-comment >% Simulate Using Numerical Integration</span>
dxdt = @(t,x,u) [
    x(<span class=hljs-number >2</span>);
    ((I + mr*l^<span class=hljs-number >2</span>) * u + (I + mr*l^<span class=hljs-number >2</span>)*mr*l*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>)) + mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>))...
    - (I + mr*l^<span class=hljs-number >2</span>)*b*x(<span class=hljs-number >2</span>)) / ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>);
    x(<span class=hljs-number >4</span>);  
    (b*x(<span class=hljs-number >2</span>) - mr*l*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span> - (mr + mc)*mr*g*l*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) - mr * l * <span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))* u) /...
    ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>) 
    ];

<span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
x(:,<span class=hljs-number >1</span>) = x0;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 4</span>
r = <span class=hljs-number >4</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)
    e(<span class=hljs-number >1</span>, idx)   = r - x(<span class=hljs-number >1</span>,idx);
    <span class=hljs-keyword >if</span> idx &gt; <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Kc*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-2</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >1</span>
        u(<span class=hljs-number >1</span>,idx) = Ka*e(<span class=hljs-number >1</span>,idx); 
    <span class=hljs-keyword >end</span>
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
[xstep, tstep] = step(<span class=hljs-number >4</span>*Gcl, t);
<span class=hljs-built_in >plot</span>(tstep,xstep, <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >2</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Step&quot;</span>, <span class=hljs-string >&quot;Numerical Integration&quot;</span>])
grid on</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_13_1.png" alt=""> <p>The numerical integration simulation has a different response, can you guess <em>why</em>? Are the models the same?</p> <p><strong> <span style='color:green'>EXERCISE 6</span></strong></p> <p>Create a new model of the crane which includes a small random disturbance in the input, then apply it in the simulation and test your controller performance again.</p> <ul> <li><p>Here the input inside the simulation would be <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><msub><mi>u</mi><mi>c</mi></msub><mo>+</mo><mi>ω</mi></mrow><annotation encoding="application/x-tex">u = u_{c} + \omega</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">u_{c}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the output of the controller and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span> is the disturbance noise.</p> <li><p>The disturbance <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>, should be a zero-mean, normally distributed noise with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">\sigma = 500</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span><span class=mord >0</span><span class=mord >0</span></span></span></span>.</p> <li><p>You can choose to emulate a single direction noise – as if wind was blowing on the crane/payload.</p> </ul> <p>Plot the position variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">x,\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> in one subplot, the velocity variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{x},\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> in another subplot, and the output <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">u(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> in the third subplot.</p> <pre><code class="matlab hljs">dxdt_noisy = @(t,x,u) [
    x(<span class=hljs-number >2</span>);
    ((I + mr*l^<span class=hljs-number >2</span>) * (u+<span class=hljs-number >500</span>*<span class=hljs-built_in >randn</span>()) + (I + mr*l^<span class=hljs-number >2</span>)*mr*l*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>)) + mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) - (I + mr*l^<span class=hljs-number >2</span>)*b*x(<span class=hljs-number >2</span>)) /...
    ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>);
    x(<span class=hljs-number >4</span>);  
    (b*x(<span class=hljs-number >2</span>) - mr*l*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span> - (mr + mc)*mr*g*l*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) - mr * l * <span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))* (u+<span class=hljs-number >500</span>*<span class=hljs-built_in >randn</span>())) / ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) ...
    - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>) 
    ];

<span class=hljs-comment >% Initialize Simulation Vectors</span>
xnoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
xnoisy(:,<span class=hljs-number >1</span>) = x0;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 4</span>
r = <span class=hljs-number >4</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)
    e(<span class=hljs-number >1</span>, idx)   = r - xnoisy(<span class=hljs-number >1</span>,idx);
    <span class=hljs-keyword >if</span> idx &gt; <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Kc*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-2</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >1</span>
        u(<span class=hljs-number >1</span>,idx) = Ka*e(<span class=hljs-number >1</span>,idx); 
    <span class=hljs-keyword >end</span>
    xdot = dxdt_noisy(t(<span class=hljs-number >1</span>, idx), xnoisy(:,idx), u(<span class=hljs-number >1</span>,idx));
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        xnoisy(:,idx+<span class=hljs-number >1</span>) = xnoisy(:,idx) + xdot*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Position [m]&quot;</span>); title(<span class=hljs-string >&quot;Cart Position Response&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_16_1.png" alt=""> <h3 id=iic_payload-only_position_control_and_disturbance_rejection_via_pid_control ><a href="#iic_payload-only_position_control_and_disturbance_rejection_via_pid_control">II.C Payload-Only Position Control and Disturbance Rejection via PID Control</a></h3> <p><strong> <span style='color:green'>EXERCISE 7</span></strong></p> <p>Repeat the same steps in II.B, but this time design your controller around <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>2</mn></msub><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">G_{2}(s)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span></span>, the transfer function relating the input to the payload angle position.</p> <p>Given the transfer function relating the input to payload angular position, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>2</mn></msub><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">G_{2}(s)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span></span>, implement a regulator to control the payload angle.</p> <p>Implement your designed controller in the crane simulation provided, without disturbance, for a step input <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo fence=true >(</mo><mi>t</mi><mo fence=true >)</mo></mrow><mo>=</mo><mn>0</mn><mi>r</mi><mi>a</mi><mi>d</mi><mtext>/</mtext><mi>s</mi></mrow><annotation encoding="application/x-tex">r\left( t \right) = 0rad\text{/}s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">t</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord text"><span class=mord >/</span></span><span class="mord mathnormal">s</span></span></span></span> but change the initial condition s.t. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>0</mn></msub><mo>=</mo><mi>π</mi><mtext>/</mtext><mn>2</mn></mrow><annotation encoding="application/x-tex">\theta_{0} = \pi\text{/}2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord text"><span class=mord >/</span></span><span class=mord >2</span></span></span></span>, this is analogous to holding the payload at an angle, then releasing it and having the controller bring the position <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> to zero, hopefully faster than it would on its own.</p> <p>Plot the position variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">x,\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> in one subplot, the velocity variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{x},\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> in another subplot, and the output <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">u(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> in the third subplot. Simulate the response with and without disturance.</p> <pre><code class="matlab hljs"><span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
xnoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
unoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
enoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >1.5</span>; <span class=hljs-number >0</span>];
xnoisy(:,<span class=hljs-number >1</span>) = x0;
x(:,<span class=hljs-number >1</span>) = x0;

Kp = <span class=hljs-number >-4.9</span>; Ki = <span class=hljs-number >0</span>; Kd = <span class=hljs-number >-8.5</span>;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 0</span>
r = <span class=hljs-number >0</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)
    e(<span class=hljs-number >1</span>, idx)   = r - x(<span class=hljs-number >3</span>,idx);
    enoisy(<span class=hljs-number >1</span>, idx)   = r - xnoisy(<span class=hljs-number >3</span>,idx);
    
    <span class=hljs-keyword >if</span> idx &gt; <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Kc*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-2</span>);
        unoisy(<span class=hljs-number >1</span>,idx) = unoisy(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*enoisy(<span class=hljs-number >1</span>,idx) +Kb*enoisy(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Kc*enoisy(<span class=hljs-number >1</span>,idx<span class=hljs-number >-2</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >2</span>
        u(<span class=hljs-number >1</span>,idx) = u(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*e(<span class=hljs-number >1</span>,idx) +Kb*e(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>);
        unoisy(<span class=hljs-number >1</span>,idx) = unoisy(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>) + Ka*enoisy(<span class=hljs-number >1</span>,idx) +Kb*enoisy(<span class=hljs-number >1</span>,idx<span class=hljs-number >-1</span>);
    <span class=hljs-keyword >elseif</span> idx == <span class=hljs-number >1</span>
        u(<span class=hljs-number >1</span>,idx) = Ka*e(<span class=hljs-number >1</span>,idx);
        unoisy(<span class=hljs-number >1</span>,idx) = Ka*enoisy(<span class=hljs-number >1</span>,idx);
    <span class=hljs-keyword >end</span>
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    xdot_noisy = dxdt_noisy(t(<span class=hljs-number >1</span>, idx), xnoisy(:,idx), unoisy(<span class=hljs-number >1</span>,idx));
    
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
        xnoisy(:,idx+<span class=hljs-number >1</span>) = xnoisy(:,idx) + xdot_noisy*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Angle [$\theta$]&quot;</span>,<span class=hljs-string >&#x27;Interpreter&#x27;</span>,<span class=hljs-string >&#x27;latex&#x27;</span>); title(<span class=hljs-string >&quot;Payload Response&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_18_1.png" alt=""> <h3 id=iid_crane_control_via_full_state_feedback ><a href="#iid_crane_control_via_full_state_feedback">II.D Crane Control via Full State Feedback</a></h3> <p>Note that you were only able to control either the cart position or the payload position with the transfer function / root-locus design approach above. We can, instead, apply a full state feedback controller if we wish to &quot;attack&quot; and stabilize multiple states/outputs simultaneously.</p> <p>Given the open-loop state-space model of a system</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mover accent=true ><mi mathvariant=bold >x</mi><mo>˙</mo></mover><mo lspace=0em  rspace=0em >=</mo><mi mathvariant=bold >A</mi><mrow><mi mathvariant=bold >x</mi><mo>+</mo></mrow><mi mathvariant=bold >B</mi><mi>u</mi><mo separator=true >,</mo><mtext> </mtext><mi>u</mi><mo lspace=0em  rspace=0em >∈</mo><msup><mi mathvariant=script >R</mi><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">\dot{\mathbf{x}}\mathbf{=}\mathbf{A}\mathbf{x +}\mathbf{B}u,\, u\mathbf{\in}\mathcal{R}^{1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6813em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span></span><span style="top:-3.01344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mord ><span class=mrel >=</span></span><span class=mord ><span class="mord mathbf">A</span></span><span class=mord ><span class="mord mathbf">x</span><span class=mord >+</span></span><span class=mord ><span class="mord mathbf">B</span></span><span class="mord mathnormal">u</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">u</span><span class=mord ><span class=mrel >∈</span></span><span class=mord ><span class=mord ><span class="mord mathcal">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mi mathvariant=bold >y</mi><mo>∈</mo></mrow><msup><mi mathvariant=script >R</mi><mn>1</mn></msup><mo lspace=0em  rspace=0em >=</mo><mi mathvariant=bold >C</mi><mi mathvariant=bold >x</mi></mrow><annotation encoding="application/x-tex">\mathbf{y \in}\mathcal{R}^{1}\mathbf{=}\mathbf{C}\mathbf{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span></span><span class=mord ><span class=mord ><span class="mord mathcal">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mord ><span class=mrel >=</span></span><span class=mord ><span class="mord mathbf">C</span></span><span class=mord ><span class="mord mathbf">x</span></span></span></span></span></span> <p>If we define our controller output as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>r</mi><mo>−</mo><mtext>Kx</mtext></mrow><annotation encoding="application/x-tex">u = r - \mathbf{\text{Kx}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord ><span class="mord text"><span class=mord >Kx</span></span></span></span></span></span>, which is the state feedback controller output, then the closed-loop state-space system becomes:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mover accent=true ><mi mathvariant=bold >x</mi><mo>˙</mo></mover><mrow><mo>=</mo><mi mathvariant=bold >A</mi><mi mathvariant=bold >x</mi><mo>+</mo><mi mathvariant=bold >B</mi></mrow><mrow><mo fence=true >(</mo><mrow><mi mathvariant=bold >r</mi><mo>−</mo><mi mathvariant=bold >K</mi><mi mathvariant=bold >x</mi></mrow><mo fence=true >)</mo></mrow><mo lspace=0em  rspace=0em >=</mo><mrow><mo fence=true >(</mo><mrow><mi mathvariant=bold >A</mi><mo>−</mo><mi mathvariant=bold >B</mi><mi mathvariant=bold >K</mi></mrow><mo fence=true >)</mo></mrow><mrow><mi mathvariant=bold >x</mi><mo>+</mo><mi mathvariant=bold >B</mi><mi mathvariant=bold >r</mi></mrow></mrow><annotation encoding="application/x-tex">\dot{\mathbf{x}}\mathbf{= Ax + B}\left( \mathbf{r - Kx} \right)\mathbf{=}\left( \mathbf{A - BK}\right)\mathbf{x + Br}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6813em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span></span><span style="top:-3.01344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mord ><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathbf">A</span><span class="mord mathbf">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">B</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">K</span><span class="mord mathbf">x</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">A</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">B</span><span class="mord mathbf">K</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathbf">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">B</span><span class="mord mathbf">r</span></span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi mathvariant=bold >y</mi><mo>=</mo><mi mathvariant=bold >C</mi><mi mathvariant=bold >x</mi></mrow><annotation encoding="application/x-tex">\mathbf{y = Cx}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathbf">C</span><span class="mord mathbf">x</span></span></span></span></span></span> <p>Remembering that the poles of the closed-loop system are the eigenvalues of the system matrix <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence=true >(</mo><mrow><mi mathvariant=bold >A</mi><mo>−</mo><mi mathvariant=bold >B</mi><mi mathvariant=bold >K</mi></mrow><mo fence=true >)</mo></mrow><mo separator=true  lspace=0em  rspace=0em >,</mo></mrow><annotation encoding="application/x-tex">\left( \mathbf{A - BK} \right)\mathbf{,}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">A</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">B</span><span class="mord mathbf">K</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mpunct >,</span></span></span></span></span> in which the characteristic polynomial of the closed-loop system <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>d</mi><mi>e</mi><mi>t</mi><mrow><mo fence=true >(</mo><mrow><mi mathvariant=bold >A</mi><mo>−</mo><mi mathvariant=bold >B</mi><mi mathvariant=bold >K</mi></mrow><mo fence=true >)</mo></mrow><mrow><mo>=</mo><mn mathvariant=bold >0</mn></mrow></mrow><annotation encoding="application/x-tex">= det\left( \mathbf{A - BK} \right)\mathbf{= 0}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.36687em;vertical-align:0em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathbf">A</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathbf">B</span><span class="mord mathbf">K</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathbf">0</span></span></span></span></span></p> <p>Knowing we have <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n = 4</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >4</span></span></span></span> states, the characteristic polynomial of the system is of the form</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mrow><mo fence=true >(</mo><mi>s</mi><mo fence=true >)</mo></mrow><mo>=</mo><msub><mi>a</mi><mn>4</mn></msub><msup><mi>s</mi><mn>4</mn></msup><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><msup><mi>s</mi><mn>3</mn></msup><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>s</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p\left( s \right) = a_{4}s^{4} + a_{3}s^{3} + a_{2}s^{2} + a_{1}s + a_{0} = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">s</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0141079999999998em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0141079999999998em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0141079999999998em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span> <p>If we wish that the system exhibits a specific transient response, we can then choose the location of our <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> poles to achieve this response, then match the values of the gain matrix <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">K</span></span></span></span></span> to the coefficients of the polynomial <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">p(s)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span></span>, then use those calculated gains in our controller.</p> <p>With full state feedback, the controller is function of a weighted average of all the system states, unlike the PID Controller which is a function of the error between the reference and a single output.</p> <p><strong> <span style='color:green'>EXERCISE 8</span></strong></p> <p>Given the state-space model of the system, define the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n = 4</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >4</span></span></span></span> pole locations in the s-plane, then use the MATLAB built-in command <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=false >(</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">place()</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">e</span><span class=mopen >(</span><span class=mclose >)</span></span></span></span>, to compute the gain matrix <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >K</mi><mo>∈</mo><msup><mi mathvariant=script >R</mi><mrow><mn>4</mn><mo>×</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{K} \in \mathcal{R}^{4 \times 1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72521em;vertical-align:-0.0391em;"></span><span class=mord ><span class="mord mathbf">K</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathcal">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>.</p> <p>It helps to first observe the root-locus shape from PART III.A, then reasonably judge where you would want to place the dominant complex poles and the additional two poles.</p> <p>Simulate the response of the system using <em>lsim&#40;&#41;,</em> with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> and the initial condition <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><msup><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>π</mi><mtext>/</mtext><mn>4</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">x_{0} = \begin{bmatrix} 0 &amp; 0 &amp; \pi\text{/}4 &amp; 0 \\ \end{bmatrix}^{T}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.431241em;vertical-align:-0.35001em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord text"><span class=mord >/</span></span><span class=mord >4</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>. Through trial and error, repeat tasks 1 and 2 until you achieve a settling time for both the payload angle and cart position of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>s</mi></msub><mo>&lt;</mo><mn>5</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">T_{s} &lt; 5s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span><span class="mord mathnormal">s</span></span></span></span> &#40;the payload reaches <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>≈</mo><mn>0</mn><mi>r</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">\theta \approx 0rad</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord >0</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span> and cart reaches <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≈</mo><mn>0</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">x \approx 0m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.48312em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class="mord mathnormal">m</span></span></span></span> as well, in under 5s&#41;</p> <ul> <li><p>Note that you can use the MATLAB function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>s</mi><mo stretchy=false >(</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">ss()</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class=mopen >(</span><span class=mclose >)</span></span></span></span> to build a MATLAB dynamic system from the state-space matrices.</p> <li><p>Note that for the closed-loop system your &quot;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">A</span></span></span></span></span>&quot; matrix is <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi mathvariant=bold >A</mi><mo>−</mo><mi mathvariant=bold >B</mi><mi mathvariant=bold >K</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{A} - \mathbf{B}\mathbf{K})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathbf">A</span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathbf">B</span></span><span class=mord ><span class="mord mathbf">K</span></span><span class=mclose >)</span></span></span></span>, where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >K</mi></mrow><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">K</span></span></span></span></span> is the gain matrix calculated in task 1.</p> </ul> <p>Plot the position variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">x,\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> in one subplot, the velocity variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{x},\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> in another subplot.</p> <p>Implement your controller in the crane simulation provided, with and without disturbance.</p> <ul> <li><p>Note that you will need to replace the PID controller with the state feedback controller <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>r</mi><mo>−</mo><mi mathvariant=bold >K</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">u = r - \mathbf{K}x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">K</span></span><span class="mord mathnormal">x</span></span></span></span></p> </ul> <p>Looks like magic? Well, in real-world systems it is often not practical, if even possible, to measure all the states of the system. But instead, we can implement a state observer to &quot;estimate&quot; the states of the system from the available measurements. Conceptually, an observer is analogous to running a model in reverse: if we can see a few <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> outputs, and know the input to the system <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>, then what were the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> states that &quot;could have&quot; caused this output?</p> <pre><code class="matlab hljs">p1 = <span class=hljs-number >-2</span>+<span class=hljs-number >10</span><span class=hljs-built_in >i</span>;
p2 = <span class=hljs-number >-2</span><span class=hljs-number >-10</span><span class=hljs-built_in >i</span>;
p3 = <span class=hljs-number >-5</span>;
p4 = <span class=hljs-number >-6</span>;
K = place(A,B,[p1 p2 p3 p4]);
sys_cl = ss(A-B*K,B,C,<span class=hljs-number >0</span>);


r = t*<span class=hljs-number >0</span>;
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >1.5</span>; <span class=hljs-number >0</span>];
[xlsim,tlsim] = lsim(sys_cl,r,t,x0);

<span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
xnoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
unoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
enoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x(:,<span class=hljs-number >1</span>) = x0;
xnoisy(:,<span class=hljs-number >1</span>) = x0;

Kp = <span class=hljs-number >-0.7</span>; Ki = <span class=hljs-number >0</span>; Kd = <span class=hljs-number >-70</span>;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 0</span>
r = <span class=hljs-number >0</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)

    u(<span class=hljs-number >1</span>, idx) = r - K*x(:,idx);
    unoisy(<span class=hljs-number >1</span>, idx) = r - K*xnoisy(:,idx);
    
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    xdot_noisy = dxdt_noisy(t(<span class=hljs-number >1</span>, idx), xnoisy(:,idx), unoisy(<span class=hljs-number >1</span>,idx));
    
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
        xnoisy(:,idx+<span class=hljs-number >1</span>) = xnoisy(:,idx) + xdot_noisy*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
subplot(<span class=hljs-number >211</span>)
<span class=hljs-built_in >plot</span>(tlsim(:,<span class=hljs-number >1</span>),xlsim(:,<span class=hljs-number >1</span>), <span class=hljs-string >&#x27;b:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;lsim(ss)&quot;</span>, <span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Position [m]&quot;</span>); title(<span class=hljs-string >&quot;Cart Response&quot;</span>)

subplot(<span class=hljs-number >212</span>)
<span class=hljs-built_in >plot</span>(tlsim(:,<span class=hljs-number >1</span>),xlsim(:,<span class=hljs-number >2</span>), <span class=hljs-string >&#x27;b:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >2</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;lsim(ss)&quot;</span>, <span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Angle [$\theta$]&quot;</span>,<span class=hljs-string >&#x27;Interpreter&#x27;</span>,<span class=hljs-string >&#x27;latex&#x27;</span>); title(<span class=hljs-string >&quot;Payload Response&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_20_1.png" alt=""> <h2 id=part_iii_multiple_output_controller_design_for_an_unstable_nonlinear_system ><a href="#part_iii_multiple_output_controller_design_for_an_unstable_nonlinear_system">PART III: MULTIPLE OUTPUT CONTROLLER DESIGN FOR AN UNSTABLE NONLINEAR SYSTEM</a></h2> <h3 id=inverted_pendulum_system ><a href="#inverted_pendulum_system"><strong>Inverted Pendulum System</strong></a></h3> <p>Let us apply a full state feedback controller to stabilize an inverted pendulum on a cart system.</p> <p>The inverted pendulum model is a classic case in the study of control of mechanical systems. The system exhibits a combined rotation and translation and is nonlinear. The system is also a classic example of unstable systems. The Segway shown on Figure 3 Inverted Pendulum or what&#39;s commonly known as the &quot;hoverboard&quot; are examples of an inverted pendulum system.</p> <p>The inverted pendulum is commonly modeled as a car moving laterally with a rod attached to it that rotates about a pivot fixed on the cart, with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> when the rod is perfectly vertical. The input to the system is a force acting on the cart in the lateral direction, as shown on Figure 3</p> <table style="width:100%"> <tr> <th><center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/media/Inverted_Pendulum.svg" style="max-width:300px"></center> <th><center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/media/Segway.svg" style="max-height:300px"></center> </table> <p><strong> <center>Figure 3 - Inverted Pendulum</center></strong></p> <p>The equations of motion for the above system are given as follows, note that they are derived from the crane model by substituting</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mtext>pendulum</mtext></msub><mo>=</mo><msub><mi>θ</mi><mtext>crane</mtext></msub><mo>+</mo><mi>π</mi></mrow><annotation encoding="application/x-tex">\theta_{\text{pendulum}} = \theta_{\text{crane}} + \pi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">pendulum</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">crane</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>; giving <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mtext>pendulum</mtext></msub><mo>=</mo><mo>−</mo><mi>s</mi><mi>i</mi><mi>n</mi><msub><mi>θ</mi><mtext>cart</mtext></msub><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex">\sin\theta_{\text{pendulum}} = -sin\theta_{\text{cart}}, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class=mop >sin</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">pendulum</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >−</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cart</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mtext>pendulum</mtext></msub><mo>=</mo><mo>−</mo><mi>c</mi><mi>o</mi><mi>s</mi><msub><mi>θ</mi><mtext>cart</mtext></msub></mrow><annotation encoding="application/x-tex">\cos\theta_{\text{pendulum}} = -cos\theta_{\text{cart}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class=mop >cos</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">pendulum</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord >−</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cart</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. </p> <p>The equilibrium point is now defined where the rod is pointing upwards.</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.24999999999999992em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>c</mi></msub><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mo fence=true >)</mo></mrow><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo>+</mo><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>−</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mo>−</mo><msub><mi>m</mi><mi>r</mi></msub><mi>g</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mtext>cosθ</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \left( m_{c} + m_{r} \right)\ddot{x} + b\dot{x} - m_{r}l\ddot{\theta}cos\theta +m_{r}l{\dot{\theta}}^{2}sin\theta = f(t)\\ \left( I + m_{r}l^{2} \right)\ddot{\theta} - m_{r}glsin\theta = m_{r}l\ddot{x}\text{cosθ} \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.3866080000000003em;vertical-align:-1.4433040000000001em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.9433040000000001em;"><span style="top:-3.9433040000000004em;"><span class=pstrut  style="height:3.135308em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span><span style="top:-2.352004em;"><span class=pstrut  style="height:3.135308em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class="mord text"><span class=mord >cosθ</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4433040000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>Where b is the coefficient of friction between the wheels and the surface, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">m_{r}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">m_{c}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are the rod and cart mass respectively, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> is the rod&#39;s moment of inertia about its center of mass, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> is the distance from the pivot to the center of mass for the rod and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> is the gravity constant.</p> <p>After algebraic manipulation the decoupled &#40;in the 2^nd^ derivative&#41; model of the pendulum on a cart system is</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.24999999999999992em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >(</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>c</mi></msub><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mo fence=true >)</mo></mrow><mo>−</mo><msubsup><mi>m</mi><mi>r</mi><mn>2</mn></msubsup><msup><mi>l</mi><mn>2</mn></msup><msup><mo><mi>cos</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>θ</mi><mo fence=true >)</mo></mrow><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo>+</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>−</mo><msubsup><mi>m</mi><mi>r</mi><mn>2</mn></msubsup><msup><mi>l</mi><mn>2</mn></msup><mi>g</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>+</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>=</mo><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >(</mo><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>r</mi></msub><mo>+</mo><msub><mi>m</mi><mi>c</mi></msub><mo fence=true >)</mo></mrow><mrow><mo fence=true >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo fence=true >)</mo></mrow><mo>−</mo><msubsup><mi>m</mi><mi>r</mi><mn>2</mn></msubsup><msup><mi>l</mi><mn>2</mn></msup><msup><mo><mi>cos</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>θ</mi><mo fence=true >)</mo></mrow><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mo>−</mo><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo>−</mo><msub><mi>m</mi><mi>r</mi></msub><mtext>lcosθ</mtext><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mo>−</mo><mrow><mo fence=true >(</mo><msub><mi>m</mi><mi>r</mi></msub><mo>+</mo><msub><mi>m</mi><mi>c</mi></msub><mo fence=true >)</mo></mrow><msub><mi>m</mi><mi>r</mi></msub><mi>g</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><msub><mi>m</mi><mi>r</mi></msub><mi>l</mi><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \left( \left( I + m_{r}l^{2} \right)\left( m_{c} + m_{r} \right) - m_{r}^{2}l^{2}\cos^{2}\theta \right)\ddot{x} + \left( I + m_{r}l^{2} \right)m_{r}l{\dot{\theta}}^{2}cos\theta - m_{r}^{2}l^{2}gcos\theta sin\theta + \left( I + m_{r}l^{2} \right)b\dot{x} = \left( I + m_{r}l^{2} \right)f(t) \\ \left( \left( m_{r} + m_{c} \right)\left( I + m_{r}l^{2} \right) - m_{r}^{2}l^{2}\cos^{2}\theta \right)\ddot{\theta} - b\dot{x} - m_{r}\text{lcosθ}{\dot{\theta}}^{2} - \left( m_{r} + m_{c} \right)m_{r}glsin\theta = m_{r}lcos\theta f(t) \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.5906160000000003em;vertical-align:-1.545308em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.0453080000000003em;"><span style="top:-4.045308em;"><span class=pstrut  style="height:3.135308em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class=mop >cos</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span><span style="top:-2.2500000000000004em;"><span class=pstrut  style="height:3.135308em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop ><span class=mop >cos</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class=mord >lcosθ</span></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.545308em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>Using the same model parameters as in Part II</p> <h3 id=iiia_linearizing_modeling_in_state-space_form ><a href="#iiia_linearizing_modeling_in_state-space_form">III.A Linearizing, Modeling in State-Space Form</a></h3> <p><strong> <span style='color:green'>EXERCISE 9</span></strong></p> <p>Using the <em>Crane</em> model function file provided, create a new one to model the inverted pendulum by comparing the EOM in equations &#40;2&#41; with equations &#40;9&#41;.</p> <ul> <li><p>It is just a few sign changes from the Crane model</p> <li><p>To animate the pendulum, flip the sign of rod line &#40;lines 92 and 103-104&#41;</p> </ul> <p>Create another model with input disturbace <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span> that is zero mean with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\sigma = 50</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span><span class=mord >0</span></span></span></span>.</p> <p>Linearize the inverted pendulum model above from the equations above and construct the state-space representation of the system. Provide your answer within the MATLAB script. Construct your output vector as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mi>θ</mi></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">y = \begin{bmatrix} x \\ \theta \\ \end{bmatrix} = \begin{bmatrix} x_{1} \\ x_{3} \\ \end{bmatrix}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p> <ul> <li><p>To linearize: assume the following approximations: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>≈</mo><mi>θ</mi><mo separator=true >,</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>≈</mo><mn>1</mn><mo separator=true >,</mo><msup><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mn>2</mn></msup><mo>≈</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">sin\theta \approx \theta,cos\theta \approx 1,{\dot{\theta}}^{2} \approx 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.329748em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.135308em;"><span style="top:-3.3842000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></p> <li><p>Again, a few sign changes compared to the crane state-space model.</p> </ul> <pre><code class="matlab hljs">clear all;
mr = <span class=hljs-number >2</span>; mc = <span class=hljs-number >10</span>; I = <span class=hljs-number >0.106</span>; b = <span class=hljs-number >20</span>; l = <span class=hljs-number >.4</span>; g = <span class=hljs-number >9.81</span>;
Den = ((I + mr*l^<span class=hljs-number >2</span>) * (mc + mr) - mr^<span class=hljs-number >2</span> * l^<span class=hljs-number >2</span>);
A = [
    <span class=hljs-number >0</span>, <span class=hljs-number >1</span>, <span class=hljs-number >0</span>, <span class=hljs-number >0</span>;
    <span class=hljs-number >0</span>, -(I + mr*l^<span class=hljs-number >2</span>)*b/Den, +mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g/Den, <span class=hljs-number >0</span>; 
    <span class=hljs-number >0</span>, <span class=hljs-number >0</span>, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>;
    <span class=hljs-number >0</span>, b/Den, +(mr + mc)*mr*g*l, <span class=hljs-number >0</span>
    ];
B = [<span class=hljs-number >0</span>; (I + mr*l^<span class=hljs-number >2</span>)/Den; <span class=hljs-number >0</span>; mr*l/Den];
C = [<span class=hljs-number >1</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >0</span>; <span class=hljs-number >0</span> <span class=hljs-number >0</span> <span class=hljs-number >1</span> <span class=hljs-number >0</span>];
D = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>];

[num,den] = ss2tf(A,B,C,D);
Ginv_cart = tf(num(<span class=hljs-number >1</span>,:),den)
Ginv_pendulum = tf(num(<span class=hljs-number >2</span>,:),den)</code></pre> <pre><code class="plaintext hljs">Ginv_cart =
     
        0.09526 s^2 - 1.692e-16 s - 8.72
      -------------------------------------
      s^4 + 1.905 s^3 - 94.18 s^2 - 185.7 s
     
    Continuous-time transfer function.
    
    
    Ginv_pendulum =
     
              0.1789 s^2 + 0.7668 s
      -------------------------------------
      s^4 + 1.905 s^3 - 94.18 s^2 - 185.7 s
     
    Continuous-time transfer function.</code></pre> <h3 id=iiib_inverted_pendulum_control_via_full_state_feedback_pole_placement ><a href="#iiib_inverted_pendulum_control_via_full_state_feedback_pole_placement">III.B Inverted Pendulum Control via Full State Feedback – Pole Placement</a></h3> <p><strong> <span style='color:green'>EXERCISE 10</span></strong></p> <p>Given the state-space model of the system, define the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n = 4</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >4</span></span></span></span> pole locations in the s-plane, then use the MATLAB built-in command <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=false >(</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">place()</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">e</span><span class=mopen >(</span><span class=mclose >)</span></span></span></span>, to compute the gain matrix <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >K</mi><mo>∈</mo><msup><mi mathvariant=script >R</mi><mrow><mn>4</mn><mo>×</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{K} \in \mathcal{R}^{4 \times 1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72521em;vertical-align:-0.0391em;"></span><span class=mord ><span class="mord mathbf">K</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathcal">R</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mbin mtight">×</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>.</p> <p>Simulate the response of the closed-loop system using <em>lsim&#40;&#41;,</em> with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> and initial condition <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><msup><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>π</mi><mtext>/</mtext><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">x_{0} = \begin{bmatrix} 0 &amp; 0 &amp; \pi\text{/}2 &amp; 0 \\ \end{bmatrix}^{T}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.431241em;vertical-align:-0.35001em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord text"><span class=mord >/</span></span><span class=mord >2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>. Repeat tasks 1 &amp; 2 until you achieve a stable response and settling time for both the cart and pendulum of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>s</mi></msub><mo>&lt;</mo><mn>10</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">T_{s} &lt; 10s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >0</span><span class="mord mathnormal">s</span></span></span></span> &#40;the pendulum reaches <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>≈</mo><mn>0</mn><mi>r</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">\theta \approx 0rad</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord >0</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span> and cart reaches <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≈</mo><mn>0</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">x \approx 0m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.48312em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class="mord mathnormal">m</span></span></span></span> as well, in under 10s&#41;</p> <p>Plot the position variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">x,\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> in one subplot, the velocity variables <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{x},\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> in another subplot.</p> <ul> <li><p>Implement your controller in the inverted pendulum simulation provided, with and without disturbance.</p> </ul> <pre><code class="matlab hljs">dt = <span class=hljs-number >0.0001</span>;
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >10</span>;

p1 = <span class=hljs-number >-2.75</span> + <span class=hljs-number >1.25</span>;
p2 = <span class=hljs-number >-2.75</span> - <span class=hljs-number >1.25</span>;
p3 = <span class=hljs-number >-7.5</span>;
p4 = <span class=hljs-number >-13</span>;
K = place(A,B,[p1 p2 p3 p4]);
sys_cl = ss(A-B*K,B,C,<span class=hljs-number >0</span>);

dxdt = @(t,x,u) [
    x(<span class=hljs-number >2</span>);
    ((I + mr*l^<span class=hljs-number >2</span>) * u - (I + mr*l^<span class=hljs-number >2</span>)*mr*l*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>)) + mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>))...
    - (I + mr*l^<span class=hljs-number >2</span>)*b*x(<span class=hljs-number >2</span>)) / ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>);
    x(<span class=hljs-number >4</span>);  
    (b*x(<span class=hljs-number >2</span>) + mr*l*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span> + (mr + mc)*mr*g*l*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) + mr * l * <span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))* u) /...
    ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>) 
    ];
    
dxdt_noisy = @(t,x,u) [
    x(<span class=hljs-number >2</span>);
    ((I + mr*l^<span class=hljs-number >2</span>) * (u+<span class=hljs-number >100</span>*<span class=hljs-built_in >randn</span>()) - (I + mr*l^<span class=hljs-number >2</span>)*mr*l*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>)) + mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>))...
    - (I + mr*l^<span class=hljs-number >2</span>)*b*x(<span class=hljs-number >2</span>)) / ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>);
    x(<span class=hljs-number >4</span>);  
    (b*x(<span class=hljs-number >2</span>) + mr*l*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span> + (mr + mc)*mr*g*l*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) + mr * l * <span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))* (u+<span class=hljs-number >100</span>*<span class=hljs-built_in >randn</span>())) /...
    ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>) 
    ];
    
r = t*<span class=hljs-number >0</span>;
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >1.5</span>; <span class=hljs-number >0</span>];
[xlsim,tlsim] = lsim(sys_cl,r,t,x0);

<span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
xnoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
unoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
enoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x(:,<span class=hljs-number >1</span>) = x0;
xnoisy(:,<span class=hljs-number >1</span>) = x0;

Kp = <span class=hljs-number >-0.7</span>; Ki = <span class=hljs-number >0</span>; Kd = <span class=hljs-number >-70</span>;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 0</span>
r = <span class=hljs-number >0</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)

    u(<span class=hljs-number >1</span>, idx) = r - K*x(:,idx);
    unoisy(<span class=hljs-number >1</span>, idx) = r - K*xnoisy(:,idx);
    
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    xdot_noisy = dxdt_noisy(t(<span class=hljs-number >1</span>, idx), xnoisy(:,idx), unoisy(<span class=hljs-number >1</span>,idx));
    
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
        xnoisy(:,idx+<span class=hljs-number >1</span>) = xnoisy(:,idx) + xdot_noisy*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
subplot(<span class=hljs-number >211</span>)
<span class=hljs-built_in >plot</span>(tlsim(:,<span class=hljs-number >1</span>),xlsim(:,<span class=hljs-number >1</span>), <span class=hljs-string >&#x27;b:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;lsim(ss)&quot;</span>, <span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Position [m]&quot;</span>); title(<span class=hljs-string >&quot;Cart Response&quot;</span>)

subplot(<span class=hljs-number >212</span>)
<span class=hljs-built_in >plot</span>(tlsim(:,<span class=hljs-number >1</span>),xlsim(:,<span class=hljs-number >2</span>), <span class=hljs-string >&#x27;b:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >2</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;lsim(ss)&quot;</span>, <span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Angle [$\theta$]&quot;</span>,<span class=hljs-string >&#x27;Interpreter&#x27;</span>,<span class=hljs-string >&#x27;latex&#x27;</span>); title(<span class=hljs-string >&quot;Payload Response&quot;</span>)

tplace = t; xplace = xnoisy;</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_25_1.png" alt=""> <h3 id=iiic_inverted_pendulum_control_via_full_state_feedback_linear_quadratic_regulator_lqr ><a href="#iiic_inverted_pendulum_control_via_full_state_feedback_linear_quadratic_regulator_lqr">III.C Inverted Pendulum Control via Full State Feedback – Linear Quadratic Regulator &#40;LQR&#41;</a></h3> <p><strong> <span style='color:green'>EXERCISE 11</span></strong></p> <p>Use the Linear Quadratic Regulator to compute the gain matrix K and simulate the response with disturbance, try to achieve a settling time for both the cart and pendulum of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>s</mi></msub><mo>&lt;</mo><mn>5</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">T_{s} &lt; 5s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span><span class="mord mathnormal">s</span></span></span></span>. Compare the poles computed by the LQR method with the poles you&#39;ve guessed earlier.</p> <ul> <li><p>Look up the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>q</mi><mi>r</mi><mo stretchy=false >(</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">lqr()</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class=mclose >)</span></span></span></span> function and MATLAB.</p> </ul> <pre><code class="matlab hljs"><span class=hljs-comment >%% LQR Design</span>
Q = <span class=hljs-built_in >eye</span>(<span class=hljs-number >4</span>);
Q(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>) = <span class=hljs-number >100</span>^<span class=hljs-number >2</span>;
Q(<span class=hljs-number >2</span>,<span class=hljs-number >2</span>) = <span class=hljs-number >10</span>^<span class=hljs-number >2</span>;
Q(<span class=hljs-number >3</span>,<span class=hljs-number >3</span>) = <span class=hljs-number >60</span>^<span class=hljs-number >2</span>;
Q(<span class=hljs-number >4</span>,<span class=hljs-number >4</span>) = <span class=hljs-number >10</span>^<span class=hljs-number >2</span>;
R = <span class=hljs-number >1</span>;
N = <span class=hljs-number >0</span>;
[K, S, P] = lqr(A,B,Q,R,N); 

sys_cl = ss(A-B*K,B,C,<span class=hljs-number >0</span>);

dxdt = @(t,x,u) [
    x(<span class=hljs-number >2</span>);
    ((I + mr*l^<span class=hljs-number >2</span>) * u - (I + mr*l^<span class=hljs-number >2</span>)*mr*l*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>)) + mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>))...
    - (I + mr*l^<span class=hljs-number >2</span>)*b*x(<span class=hljs-number >2</span>)) / ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>);
    x(<span class=hljs-number >4</span>);  
    (b*x(<span class=hljs-number >2</span>) + mr*l*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span> + (mr + mc)*mr*g*l*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) + mr * l * <span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))* u) /...
    ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>) 
    ];
    
dxdt_noisy = @(t,x,u) [
    x(<span class=hljs-number >2</span>);
    ((I + mr*l^<span class=hljs-number >2</span>) * (u+<span class=hljs-number >100</span>*<span class=hljs-built_in >randn</span>()) - (I + mr*l^<span class=hljs-number >2</span>)*mr*l*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>)) + mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*g*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>))...
    - (I + mr*l^<span class=hljs-number >2</span>)*b*x(<span class=hljs-number >2</span>)) / ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>);
    x(<span class=hljs-number >4</span>);  
    (b*x(<span class=hljs-number >2</span>) + mr*l*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))*x(<span class=hljs-number >4</span>)^<span class=hljs-number >2</span> + (mr + mc)*mr*g*l*<span class=hljs-built_in >sin</span>(x(<span class=hljs-number >3</span>)) + mr * l * <span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))* (u+<span class=hljs-number >100</span>*<span class=hljs-built_in >randn</span>())) /...
    ((I + mr*l^<span class=hljs-number >2</span>)*(mc + mr) - mr^<span class=hljs-number >2</span>*l^<span class=hljs-number >2</span>*<span class=hljs-built_in >cos</span>(x(<span class=hljs-number >3</span>))^<span class=hljs-number >2</span>) 
    ];
    
r = t*<span class=hljs-number >0</span>;
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>; <span class=hljs-number >1.5</span>; <span class=hljs-number >0</span>];
[xlsim,tlsim] = lsim(sys_cl,r,t,x0);

<span class=hljs-comment >% Initialize Simulation Vectors</span>
x = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
xnoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >4</span>, <span class=hljs-built_in >length</span>(t));
u = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
unoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
e = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));
enoisy = <span class=hljs-built_in >zeros</span>(<span class=hljs-number >1</span>, <span class=hljs-built_in >length</span>(t));

<span class=hljs-comment >% Initial Condition - Explicit Declaration</span>
x(:,<span class=hljs-number >1</span>) = x0;
xnoisy(:,<span class=hljs-number >1</span>) = x0;

Kp = <span class=hljs-number >-0.7</span>; Ki = <span class=hljs-number >0</span>; Kd = <span class=hljs-number >-70</span>;

<span class=hljs-comment >% Discrete controller gains</span>
Ka = Kp + Ki * dt / <span class=hljs-number >2</span> + Kd / dt;
Kb = -Kp + Ki * dt / <span class=hljs-number >2</span> - <span class=hljs-number >2</span> * Kd / dt;
Kc = Kd/dt;

<span class=hljs-comment >% Step Input r = 0</span>
r = <span class=hljs-number >0</span>;

<span class=hljs-comment >% Simulate </span>
<span class=hljs-keyword >for</span> idx = <span class=hljs-number >1</span>:<span class=hljs-built_in >length</span>(t)

    u(<span class=hljs-number >1</span>, idx) = r - K*x(:,idx);
    unoisy(<span class=hljs-number >1</span>, idx) = r - K*xnoisy(:,idx);
    
    xdot = dxdt(t(<span class=hljs-number >1</span>, idx), x(:,idx), u(<span class=hljs-number >1</span>,idx));
    xdot_noisy = dxdt_noisy(t(<span class=hljs-number >1</span>, idx), xnoisy(:,idx), unoisy(<span class=hljs-number >1</span>,idx));
    
    <span class=hljs-comment >% Integrate state</span>
    <span class=hljs-keyword >if</span>(idx &lt; <span class=hljs-built_in >length</span>(t))
        x(:,idx+<span class=hljs-number >1</span>) = x(:,idx) + xdot*dt;
        xnoisy(:,idx+<span class=hljs-number >1</span>) = xnoisy(:,idx) + xdot_noisy*dt;
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
subplot(<span class=hljs-number >211</span>)
<span class=hljs-built_in >plot</span>(tlsim(:,<span class=hljs-number >1</span>),xlsim(:,<span class=hljs-number >1</span>), <span class=hljs-string >&#x27;b:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;lsim(ss)&quot;</span>, <span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Position [m]&quot;</span>); title(<span class=hljs-string >&quot;Cart Response&quot;</span>)

subplot(<span class=hljs-number >212</span>)
<span class=hljs-built_in >plot</span>(tlsim(:,<span class=hljs-number >1</span>),xlsim(:,<span class=hljs-number >2</span>), <span class=hljs-string >&#x27;b:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >2</span>)
<span class=hljs-built_in >hold</span> on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),x(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
grid on
<span class=hljs-built_in >plot</span>(t(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xnoisy(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;lsim(ss)&quot;</span>, <span class=hljs-string >&quot;Ideal&quot;</span>, <span class=hljs-string >&quot;Noisy&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Angle [$\theta$]&quot;</span>,<span class=hljs-string >&#x27;Interpreter&#x27;</span>,<span class=hljs-string >&#x27;latex&#x27;</span>); title(<span class=hljs-string >&quot;Payload Response&quot;</span>)

tlqr = t; xlqr = xnoisy;</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_27_1.png" alt=""> <p>Now let&#39;s compare between the Pole Placement method and LQR method</p> <pre><code class="matlab hljs"><span class=hljs-comment >%% BLOTTING</span>
<span class=hljs-comment >%plot inline --format=svg</span>
<span class=hljs-comment >%plot inline -s 900,450</span>
<span class=hljs-comment >%plot inline -r 120</span>
<span class=hljs-built_in >figure</span>();
subplot(<span class=hljs-number >211</span>)
<span class=hljs-built_in >plot</span>(tplace(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xplace(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
grid on
<span class=hljs-built_in >plot</span>(tlqr(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xlqr(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Pole Placement&quot;</span>, <span class=hljs-string >&quot;LQR&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Position [m]&quot;</span>); title(<span class=hljs-string >&quot;Cart Response&quot;</span>)

subplot(<span class=hljs-number >212</span>)
<span class=hljs-built_in >plot</span>(tplace(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xplace(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;r&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1</span>)
<span class=hljs-built_in >hold</span> on
grid on
<span class=hljs-built_in >plot</span>(tlqr(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>),xlqr(<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>), <span class=hljs-string >&#x27;k:&#x27;</span>, <span class=hljs-string >&#x27;LineWidth&#x27;</span>, <span class=hljs-number >1.5</span>)
<span class=hljs-built_in >legend</span> ([<span class=hljs-string >&quot;Pole Placement&quot;</span>, <span class=hljs-string >&quot;LQR&quot;</span>])
xlabel(<span class=hljs-string >&quot;Time [s]&quot;</span>); ylabel(<span class=hljs-string >&quot;Angle [$\theta$]&quot;</span>,<span class=hljs-string >&#x27;Interpreter&#x27;</span>,<span class=hljs-string >&#x27;latex&#x27;</span>); title(<span class=hljs-string >&quot;Payload Response&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_4/output/output_29_1.png" alt=""> <div class=page-foot > <div class=copyright > &copy; Ali AlSaibie, PhD. Last modified: December 10, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div>