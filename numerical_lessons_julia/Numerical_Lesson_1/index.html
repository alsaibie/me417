<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/me417/libs/katex/katex.min.css"> <link rel=stylesheet  href="/me417/libs/highlight/github.min.css"> <link rel=stylesheet  href="/me417/css/franklin.css"> <link rel=stylesheet  href="/me417/css/poole_hyde.css"> <link rel=stylesheet  href="/me417/css/custom.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 968px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/me417/assets/c.svg"> <title>Numerical Lesson #1 - Julia</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <br> <img src="/me417/assets/KuwaitUniversityLogoTextLight.svg" style="width: 200px; height: auto; display: inline"> <h1 style="font-size:2em; opacity: 0.75;"><a href="/me417/">ME 417</a></h1> <p class=lead >Control of Mechanical Systems</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/me417/">Home</a> <a class="sidebar-nav-item active" href="/me417/numerical_lessons/">Numerical Lessons</a> <a class="sidebar-nav-item " href="/me417/numerical_assignments/">Numerical Assignments</a> <a class="sidebar-nav-item " href="/me417/homeworks/">Homeworks</a> <br> <small style="text-transform: uppercase; font-size: 0.75em">Class Lectures</small> <div class=part >Part I</div> <a class="sidebar-nav-item " href="/me417/part_i/lecture1/"><b>Lecture 1</b> - <em>Introduction</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture2/"><b>Lecture 2</b> - <em>Analysis and Design</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture3/"><b>Lecture 3</b> - <em>Transfer Function</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture4/"><b>Lecture 4</b> - <em>Mechanical Systems</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture5/"><b>Lecture 5</b> - <em>Electromechanical Systems</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture6/"><b>Lecture 6</b> - <em>Poles Zeros and System Response</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture7/"><b>Lecture 7</b> - <em>The General Second-Order System</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture8/"><b>Lecture 8</b> - <em>Introduction to Stability and Feedback Control</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture9/"><b>Lecture 9</b> - <em>PID Control via Gain Tuning</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture10/"><b>Lecture 10</b> - <em>Steady-State Error</em></a> <a class="sidebar-nav-item " href="/me417/part_i/lecture11/"><b>Lecture 11</b> - <em>Unity Feedback Controller Design</em></a> <div class=part >Part II</div> <a class="sidebar-nav-item " href="/me417/part_ii/lecture1/"><b>Lecture 1</b> - <em>Introduction to Root-Locus</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture2/"><b>Lecture 2</b> - <em>Sketching the Root-Locus</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture3/"><b>Lecture 3</b> - <em>Transient Response Design via Gain Adjustment</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture4/"><b>Lecture 4</b> - <em>Improving Steady-State Response</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture5/"><b>Lecture 5</b> - <em>Improving Transient Response</em></a> <a class="sidebar-nav-item " href="/me417/part_ii/lecture6/"><b>Lecture 6</b> - <em>Improving Overall Response</em></a> <div class=part >Part III</div> <a class="sidebar-nav-item " href="/me417/part_iii/lecture1/"><b>Lecture 1</b> - <em>State-Space Representation</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture2/"><b>Lecture 2</b> - <em>Stability and Steady-State Error in State-Space</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture3/"><b>Lecture 3</b> - <em>State-Space Controller Representation and Design</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture4/"><b>Lecture 4</b> - <em>Introduction to Linear Optimal Control</em></a> <a class="sidebar-nav-item " href="/me417/part_iii/lecture5/"><b>Lecture 5</b> - <em>State-Space Controller Design Problems</em></a> <div class=part >Part IV</div> <a class="sidebar-nav-item " href="/me417/part_iv/lecture1/"><b>Lecture 1</b> - <em>Introduction to Frequency Response</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture2/"><b>Lecture 2</b> - <em>Sketching Bode Plots</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture3/"><b>Lecture 3</b> - <em>Refining Second Order Systems Bode Plots</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture4/"><b>Lecture 4</b> - <em>System Identification from Frequnecy Response</em></a> <a class="sidebar-nav-item " href="/me417/part_iv/lecture5/"><b>Lecture 5</b> - <em>Stability in Frequency Response</em></a> </nav> <p>&copy; Ali AlSaibie, PhD.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=span_stylecolorgreenme_417_control_of_mechanical_systems ><a href="#span_stylecolorgreenme_417_control_of_mechanical_systems"> <span style='color:green'>ME 417 Control of Mechanical Systems</span></a></h1> <p><a href="/me417/numerical_lessons/index.html">Back to Lessons</a></p> <h3 id=numerical_lesson_1 ><a href="#numerical_lesson_1">Numerical Lesson #1</a></h3> <h2 id=part_i_simulating_a_system_response ><a href="#part_i_simulating_a_system_response">PART I: SIMULATING A SYSTEM RESPONSE</a></h2> <p>In this part you will be simulating a general second-order dynamic system using different numerical methods, and you will also be exploring the effect of changing the system parameters on the response.</p> <p>The general form of a second-order dynamic system represented by Figure 1, is given by the transfer function</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi>X</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><mrow><mi>U</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow></mfrac><mo>=</mo><mfrac><msubsup><mi>ω</mi><mi>n</mi><mn>2</mn></msubsup><mrow><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><mn>2</mn><mi>ζ</mi><msub><mi>ω</mi><mi>n</mi></msub><mi>s</mi><mo>+</mo><msubsup><mi>ω</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{X( s )}{U( s )} = \frac{\omega_{n}^{2}}{s^{2} + 2\zeta\omega_{n}s + \omega_{n}^{2}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.4241080000000004em;vertical-align:-0.933em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.933em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>Where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\omega_{n}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi></mrow><annotation encoding="application/x-tex">\zeta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span></span></span></span> are given by the definitions: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>n</mi></msub><mo>=</mo><msqrt><mfrac><mi>K</mi><mi>M</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">\omega_{n} = \sqrt{\frac{K}{M}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.84em;vertical-align:-0.5913344999999999em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.2486655000000002em;"><span class=svg-align  style="top:-3.8em;"><span class=pstrut  style="height:3.8em;"></span><span class=mord  style="padding-left:1em;"><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.2086655em;"><span class=pstrut  style="height:3.8em;"></span><span class=hide-tail  style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90 l0 -0 c4,-6.7,10,-10,18,-10 H400000v40 H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7 s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744 c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30 c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722 c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5 c53.7,-170.3,84.5,-266.8,92.5,-289.5z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.5913344999999999em;"><span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>ζ</mi><msub><mi>ω</mi><mi>n</mi></msub><mo>=</mo><mfrac><msub><mi>f</mi><mi>v</mi></msub><mi>M</mi></mfrac></mrow><annotation encoding="application/x-tex">2\zeta\omega_{n} = \frac{f_{v}}{M}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.277216em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.10764em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p> <center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_1/media/MSD.svg" style="max-width:450px"></center> <p><strong> <center>Figure 1 - General Second-Order (Spring-Mass-Damper) System</center></strong></p> <p><strong> <span style='color:green'>EXERCISE 1</span></strong></p> <p>Given the following parameters: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>7</mn><mtext>kg</mtext></mrow><annotation encoding="application/x-tex">M = 7\text{kg}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >7</span><span class="mord text"><span class=mord >kg</span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>2.8</mn><mi>N</mi><mtext>/</mtext><mi>m</mi></mrow><annotation encoding="application/x-tex">K = 2.8N\text{/}m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mord >.</span><span class=mord >8</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord text"><span class=mord >/</span></span><span class="mord mathnormal">m</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>v</mi></msub><mo>=</mo><mn>1.5</mn><mi>N</mi><mo>−</mo><mi>s</mi><mtext>/</mtext><mi>m</mi></mrow><annotation encoding="application/x-tex">f_{v} = 1.5N - s\text{/}m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mord >.</span><span class=mord >5</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord text"><span class=mord >/</span></span><span class="mord mathnormal">m</span></span></span></span></p> <p>Simulate the response of the system to a step input using the command <em>stepplot&#40;&#41;</em> in Julia from the ControlSystems.jl package. Repeat the step simulation with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>v</mi></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">f_{v} = 5</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span></span></span></span>, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>v</mi></msub><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">f_{v} = 20</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span><span class=mord >0</span></span></span></span>. Plot the three responses on the same plot. Explain the observed difference between the three responses.</p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 1</span>

<span class=hljs-keyword >using</span> ControlSystems; 
<span class=hljs-keyword >using</span> Plots;
pyplot();

M = <span class=hljs-number >7</span>;
K = <span class=hljs-number >2.8</span>;
fv = [<span class=hljs-number >1.5</span> <span class=hljs-number >5</span> <span class=hljs-number >20</span>];
wn = sqrt(K/M);
zetas = fv ./ (M * <span class=hljs-number >2</span> * wn);    
G = [ tf([wn^<span class=hljs-number >2</span>], [<span class=hljs-number >1</span>, <span class=hljs-number >2</span>*zeta*wn, wn^<span class=hljs-number >2</span>]) <span class=hljs-keyword >for</span> zeta <span class=hljs-keyword >in</span> zetas ];
<span class=hljs-meta >@show</span> G
t = <span class=hljs-number >0</span>:<span class=hljs-number >0.01</span>:<span class=hljs-number >40</span>;

p = stepplot(G, t, lw=<span class=hljs-number >3</span>,  label=[<span class=hljs-string >L&quot;F_v=&quot;</span>*<span class=hljs-string >&quot;<span class=hljs-subst >$(fv[<span class=hljs-number >1</span>])</span>&quot;</span> <span class=hljs-string >L&quot;F_v=&quot;</span>*<span class=hljs-string >&quot;<span class=hljs-subst >$(fv[<span class=hljs-number >2</span>])</span>&quot;</span> <span class=hljs-string >L&quot;F_v=&quot;</span>*<span class=hljs-string >&quot;<span class=hljs-subst >$(fv[<span class=hljs-number >3</span>])</span>&quot;</span>]);</code></pre> <pre><code class="plaintext hljs">G = TransferFunction{Continuous,ControlSystems.SisoRational{Float64}}[TransferFunction{Continuous,ControlSystems.SisoRational{Float64}}
                0.4
------------------------------------
1.0*s^2 + 0.2142857142857143*s + 0.4

Continuous-time transfer function model TransferFunction{Continuous,ControlSystems.SisoRational{Float64}}
                0.4
------------------------------------
1.0*s^2 + 0.7142857142857143*s + 0.4

Continuous-time transfer function model TransferFunction{Continuous,ControlSystems.SisoRational{Float64}}
                0.4
-----------------------------------
1.0*s^2 + 2.857142857142857*s + 0.4

Continuous-time transfer function model]
</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex1_plot.svg" alt=""></p> <p>Using the command <em>stepplot&#40;&#41;</em> is useful for analyzing a system&#39;s response to a simple and constant input to a system, but what if the input varies? We can instead use the command <em>lsimplot&#40;&#41;</em>.</p> <p>Repeat the task above, but to an input force defined by the piecewise function below, using the command <em>lsimplot&#40;&#41;</em> from ControlSystems.jl package, from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">t = 0s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class="mord mathnormal">s</span></span></span></span> to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>100</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">t = 100s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >0</span><span class=mord >0</span><span class="mord mathnormal">s</span></span></span></span>, and plot the result in a new figure.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo separator=true >,</mo><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>≤</mo><mn>1.5</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo separator=true >,</mo><mn>1.5</mn><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo>≤</mo><mn>8</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo>−</mo><mn>3</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mo separator=true >,</mo><mn>8</mn><mi>s</mi><mo>&lt;</mo><mi>t</mi><mo>≤</mo><mn>14</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>14</mn><mi>s</mi><mo>&lt;</mo><mi>t</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></mrow><mtext> </mtext></mrow><annotation encoding="application/x-tex">f( t ) = \left\{ \begin{matrix} 0 &amp; ,0 &lt; t \leq 1.5s \\ 3 &amp; ,1.5s &lt; t \leq 8s \\ \begin{matrix} - 3 \\ 0 \\ \end{matrix} &amp; \begin{matrix} ,8s &lt; t \leq 14s \\ 14s &lt; t \\ \end{matrix} \\ \end{matrix} \right.\ </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:4.800040000000001em;vertical-align:-2.15002em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.6500200000000005em;"><span style="top:-1.8999899999999998em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.89499em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.18999em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.59001em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60501em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.90002em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.15002em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.65em;"><span style="top:-5.260000000000001em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mord >0</span></span></span><span style="top:-4.06em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-2.25em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >−</span><span class=mord >3</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.1500000000000004em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.65em;"><span style="top:-5.260000000000001em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mord >.</span><span class=mord >5</span><span class="mord mathnormal">s</span></span></span><span style="top:-4.06em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mord >.</span><span class=mord >5</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >8</span><span class="mord mathnormal">s</span></span></span><span style="top:-2.25em;"><span class=pstrut  style="height:3.45em;"></span><span class=mord ><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >8</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mord >4</span><span class="mord mathnormal">s</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span><span class=mord >4</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.1500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace > </span></span></span></span> <blockquote> <p>Hint: typing ?lsimplot in Julia&#39;s REPL will guide you on how to use the function.</p> </blockquote> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 1.2</span>
dt = <span class=hljs-number >0.1</span>;
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >100</span>;

<span class=hljs-keyword >function</span> u(t)
    <span class=hljs-keyword >if</span> t &gt; <span class=hljs-number >1.5</span> &amp;&amp; t &lt;= <span class=hljs-number >8</span>
        <span class=hljs-keyword >return</span> <span class=hljs-number >3</span>
    <span class=hljs-keyword >elseif</span> t &gt; <span class=hljs-number >8</span> &amp;&amp; t &lt;= <span class=hljs-number >14</span> 
        <span class=hljs-keyword >return</span> -<span class=hljs-number >3</span>
    <span class=hljs-keyword >else</span>
        <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

p = lsimplot(G,u.(t),t, lw=<span class=hljs-number >3</span>, label=[<span class=hljs-string >L&quot;F_v=&quot;</span>*<span class=hljs-string >&quot;<span class=hljs-subst >$(fv[<span class=hljs-number >1</span>])</span>&quot;</span> <span class=hljs-string >L&quot;F_v=&quot;</span>*<span class=hljs-string >&quot;<span class=hljs-subst >$(fv[<span class=hljs-number >2</span>])</span>&quot;</span> <span class=hljs-string >L&quot;F_v=&quot;</span>*<span class=hljs-string >&quot;<span class=hljs-subst >$(fv[<span class=hljs-number >3</span>])</span>&quot;</span>]);</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex1_2_plot.svg" alt=""></p> <p>Now, what if we don&#39;t know the input function in advance, more specifically, what if the input is a function of the output of the system <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>t</mi><mo separator=true >,</mo><mi>y</mi><mo separator=true >,</mo><msub><mi>y</mi><mtext>sp</mtext></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(t,y,y_{\text{sp}})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sp</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>, as in the case of any feedback control system. In this case we must use a different method to simulate the response. Also note that the methods above require the system to be linear and time-invariant. The next methods can be used to simulate any dynamic system &#40;nonlinear and/or time-variant&#41; if the differential equations and initial conditions are defined.</p> <p>Given the following differential equation</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>a</mi><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>+</mo><mi>b</mi><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>+</mo><mi>c</mi><mi>x</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>=</mo><mi>u</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">a\ddot{x}(t) + b\dot{x}(t) + cx(t) = u(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span></span> <p>We can separate it into two equations that can then be used in MATLAB to simulate the response. Let&#39;s re-write the equation variables as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mi>x</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mover accent=true ><mi>x</mi><mo>¨</mo></mover><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">x_{1} = x(t),x_{2} = \dot{x}(t),x_{3} = \ddot{x}(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span>. If we define a vector <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >x</mi><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex"> \mathbf{x}=\begin{bmatrix} x_{1} \\ x_{2} \\ \end{bmatrix}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44444em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">x</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p> <p>then <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi mathvariant=bold >x</mi><mo>˙</mo></mover><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">\dot{\mathbf{x}} = \begin{bmatrix} {\dot{x}}_{1} \\ {\dot{x}}_{2} \\ \end{bmatrix}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6813em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6813em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span></span><span style="top:-3.01344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p> <p>In other words:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mover accent=true ><mi mathvariant=bold >x</mi><mo>˙</mo></mover><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>−</mo><mi>c</mi><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mi>b</mi><msub><mi>x</mi><mn>2</mn></msub></mrow><mi>a</mi></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex"> \dot{\mathbf{x}} = \begin{bmatrix} {\dot{x}}_{1} \\ {\dot{x}}_{2} \\ \end{bmatrix} = \begin{bmatrix} x_{2} \\ \dfrac{u( t ) - cx_{1} - bx_{2}}{a} \\ \end{bmatrix} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6813em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6813em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span></span><span style="top:-3.01344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.313em;vertical-align:-1.4065em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.9065em;"><span style="top:-4.4935em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7065em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4065em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span></span></span></span></span> <p>If we start off with some given initial conditions for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_{1},x_{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, we can numerically integrate <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi mathvariant=bold >x</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\dot{\mathbf{x}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6813em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6813em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathbf">x</span></span></span></span><span style="top:-3.01344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> at consecutive time-steps to obtain </p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=bold >x</mi><mo>=</mo></mrow><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>=</mo><mrow><mo fence=true >[</mo><mtable rowspacing=0.15999999999999992em  columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mi>x</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mover accent=true ><mi>x</mi><mo>˙</mo></mover><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x =}\begin{bmatrix} x_{1} \\ x_{2} \\ \end{bmatrix} = \begin{bmatrix} x(t) \\ \dot{x}(t) \\ \end{bmatrix}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class="mord mathbf">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.45em;"><span style="top:-3.61em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span><span style="top:-2.4099999999999997em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span> <p>over a given time period <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><msub><mi>t</mi><mi>f</mi></msub><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">t \in \lbrack 0,t_{f}\rbrack</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65418em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mclose >]</span></span></span></span>. In the following code snippet is an example on how to simulate the above equation in Julia using <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a>. which includes a number of methods for solving ordinary differential equations.</p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Code Snippet 1</span>

<span class=hljs-keyword >using</span> OrdinaryDiffEq
<span class=hljs-comment ># System Parameters</span>
a = <span class=hljs-number >2</span>; b = <span class=hljs-number >1</span>; c = <span class=hljs-number >2</span>; f = <span class=hljs-number >5</span>;
 
<span class=hljs-comment ># Initial Conditions</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
 
<span class=hljs-comment ># funtion for xdot vector. You can also</span>
<span class=hljs-comment ># define a separate function in a separate file or at the end of the</span>
<span class=hljs-comment ># script</span>
<span class=hljs-keyword >function</span> dxdt(dx,x,p,t)
    <span class=hljs-keyword >global</span> a, b, c, f;
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (f - b * x[<span class=hljs-number >2</span>] - c * x[<span class=hljs-number >1</span>]) / a;
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># Time span</span>
t = (<span class=hljs-number >0</span>,<span class=hljs-number >40</span>)
 
prob = ODEProblem(dxdt,x0,t)

<span class=hljs-comment ># Simulate using ODE Solver</span>
sol = solve(prob, Tsit5())
 
<span class=hljs-comment ># And plot</span>
p = plot(sol, lw=<span class=hljs-number >3</span>, label = [<span class=hljs-string >&quot;\$x\$&quot;</span> <span class=hljs-string >&quot;\$\\dot{x}\$&quot;</span>])</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/snp1_plot.svg" alt=""></p> <p><strong> <span style='color:green'>EXERCISE 2</span></strong></p> <p>Obtain the differential equation from the transfer function on the first page from equation &#40;1&#41;, into the form shown in equation &#40;2&#41;, then simulate the response to a <em>sinusoidal input</em> of unity magnitude and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><mn>0.1</mn><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">f = 0.1Hz</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >1</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=false >(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">u( t ) = sin(2\pi ft)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class=mopen >(</span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span>, using an ODE solver from OrdinaryDiffEq.jl package, <strong>change the value of the damping coefficient</strong> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">f_{v}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>v</mi></msub><mo>=</mo><mn>0.1</mn><mover accent=true ><mi>x</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">f_{v} = 0.1\dot{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >1</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span>. You now have a nonlinear system. Simulate for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mrow><mo fence=true >[</mo><mn>0</mn><mo separator=true >,</mo><mtext> </mtext><mn>100</mn><mi>s</mi><mo fence=true >]</mo></mrow></mrow><annotation encoding="application/x-tex">t = \left\lbrack 0,\ 100s \right\rbrack</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace > </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mord >0</span><span class=mord >0</span><span class="mord mathnormal">s</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span> and plot <em>both</em> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator=true >,</mo><mover accent=true ><mi>x</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">x,\dot{x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8623000000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.11111000000000001em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span> on the figure. Note that the differential equation for the spring-mass-damper system above can also be expressed as: </p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mfrac><mrow><msup><mi>d</mi><mn>2</mn></msup><mi>x</mi></mrow><mrow><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><msub><mi>f</mi><mi>v</mi></msub><mfrac><mtext>dx</mtext><mtext>dt</mtext></mfrac><mo>+</mo><mi>K</mi><mi>x</mi><mo>=</mo><mi>K</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">M\frac{d^{2}x}{dt^{2}} + f_{v}\frac{\text{dx}}{\text{dt}} + Kx = Ku</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.36292em;vertical-align:-0.345em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.01792em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dt</span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">dx</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal">u</span></span></span></span> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 2</span>
<span class=hljs-keyword >using</span> OrdinaryDiffEq
 
<span class=hljs-comment ># Initial Conditions</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
 
<span class=hljs-comment ># funtion for xdot vector. You can also</span>
<span class=hljs-comment ># define a separate function in a separate file or at the end of the</span>
<span class=hljs-comment ># script</span>
<span class=hljs-keyword >function</span> dxdt(dx,x,p,t)
    M = <span class=hljs-number >7</span>; K = <span class=hljs-number >2.8</span>; f = <span class=hljs-number >0.2</span>;
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (sin(<span class=hljs-number >2</span>*<span class=hljs-literal >pi</span>*f*t) - K * x[<span class=hljs-number >1</span>] - <span class=hljs-number >0.1</span> * x[<span class=hljs-number >2</span>] * x[<span class=hljs-number >2</span>]) / M;
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># Time span</span>
t = (<span class=hljs-number >0</span>,<span class=hljs-number >40</span>)
prob = ODEProblem(dxdt,x0,t)
<span class=hljs-comment ># Simulate using ODE Solver</span>
sol = solve(prob, Tsit5())
 
<span class=hljs-comment ># And plot</span>
p = plot(sol, lw=<span class=hljs-number >3</span>, label = [<span class=hljs-string >&quot;\$x\$&quot;</span> <span class=hljs-string >&quot;\$\\dot{x}\$&quot;</span>])</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex2_plot.svg" alt=""></p> <p>Another method for solving a differential equation is using basic numerical integration with a fixed time-step. This is generally less efficient for higher order systems, but is more flexible in simulating dynamic systems, specifically, in simulating systems in real-time &#40;simulating the dynamics of a car in a video-game is an example&#41;. Moreover, this method is sufficient for simulating many mechanical dynamic systems. The code snippet below shows an example of basic forward integration to simulate a second-order system response; the same system from equation &#40;<em>3</em>&#41;.</p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Code Snippet 2</span>

a = <span class=hljs-number >1</span>; b = <span class=hljs-number >1</span>; c = <span class=hljs-number >1</span>;
<span class=hljs-comment ># Initial Conditions</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
 
<span class=hljs-comment ># funtion for xdot vector - using an anonymous function. You can also</span>
<span class=hljs-comment ># define a separate function in a separate file or at the end of the</span>
<span class=hljs-comment ># script</span>
 
<span class=hljs-keyword >function</span> dxdt(x,u,t)
    <span class=hljs-keyword >global</span> a, b, c;
    dx = [<span class=hljs-number >0.0</span>; <span class=hljs-number >0.0</span>]
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (u - b * x[<span class=hljs-number >2</span>] - c * x[<span class=hljs-number >1</span>]) / a;
    <span class=hljs-keyword >return</span> dx
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># Integration Time step</span>
dt = <span class=hljs-number >0.1</span>;
<span class=hljs-comment >#  Time vector</span>
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >20</span>;
 
<span class=hljs-comment ># Initialize x</span>
x_sim = zeros(<span class=hljs-number >2</span>,length(t)); <span class=hljs-comment ># Empty 2xn array</span>
ui = zeros(<span class=hljs-number >1</span>,length(t)); <span class=hljs-comment ># Empty 1xn vector</span>
x_sim[:,<span class=hljs-number >1</span>] = x0;
 
<span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:length(t)-<span class=hljs-number >1</span>
    ui[<span class=hljs-number >1</span>,ix+<span class=hljs-number >1</span>] = sin(t[ix]); <span class=hljs-comment ># Calculate the next input value</span>
    xdot = dxdt(x_sim[:,ix], ui[<span class=hljs-number >1</span>,ix+<span class=hljs-number >1</span>], t[ix]); <span class=hljs-comment ># Grab the derivative vector</span>
    x_sim[:, ix+<span class=hljs-number >1</span>] = x_sim[:, ix] + xdot * dt; <span class=hljs-comment ># Integrate x</span>
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># And plot</span>
plot(t,ui[<span class=hljs-number >1</span>,:])
p = plot(t,x_sim[<span class=hljs-number >1</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$x\$&quot;</span>)
plot!(p, t,x_sim[<span class=hljs-number >2</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$\\dot{x}\$&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/snp2_plot.svg" alt=""></p> <p><strong> <span style='color:green'>EXERCISE 3</span></strong></p> <p>Repeat the previous task using basic numerical integration this time, with the following time steps <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\Delta t = 0.01</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >1</span></span></span></span>, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi><mo>=</mo><mn>0.001</mn></mrow><annotation encoding="application/x-tex">\Delta t = 0.001</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >0</span><span class=mord >1</span></span></span></span>. Then plot the responses from the ode45&#40;&#41; method and the basic integration method, as three subplots on the same figure. Do you notice a difference in the response between <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi><mo>=</mo><mn>0.01</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">\Delta t = 0.01s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >1</span><span class="mord mathnormal">s</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi><mo>=</mo><mn>0.001</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">\Delta t = 0.001s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >0</span><span class=mord >1</span><span class="mord mathnormal">s</span></span></span></span>?</p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 3</span>
a = <span class=hljs-number >1</span>; b = <span class=hljs-number >1</span>; c = <span class=hljs-number >1</span>;
<span class=hljs-comment ># Initial Conditions</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>];
 
<span class=hljs-comment ># funtion for xdot vector - using an anonymous function. You can also</span>
<span class=hljs-comment ># define a separate function in a separate file or at the end of the</span>
<span class=hljs-comment ># script</span>

<span class=hljs-keyword >function</span> dxdt(x,u,t)
    M = <span class=hljs-number >7</span>; K = <span class=hljs-number >2.8</span>;
    dx = [<span class=hljs-number >0.0</span>; <span class=hljs-number >0.0</span>];
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (u  - K * x[<span class=hljs-number >1</span>] - <span class=hljs-number >0.1</span> * x[<span class=hljs-number >2</span>] * x[<span class=hljs-number >2</span>]) / M;
    <span class=hljs-keyword >return</span> dx
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># Integration Time step</span>
dt = <span class=hljs-number >0.1</span>;
<span class=hljs-comment >#  Time vector</span>
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >20</span>;
f = <span class=hljs-number >0.1</span> 
<span class=hljs-comment ># Initialize x</span>
x_sim = zeros(<span class=hljs-number >2</span>,length(t)); <span class=hljs-comment ># Empty 2xn array</span>
ui = zeros(<span class=hljs-number >1</span>,length(t)); <span class=hljs-comment ># Empty 1xn vector</span>
x_sim[:,<span class=hljs-number >1</span>] = x0;
 
<span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:length(t)-<span class=hljs-number >1</span>
    ui[<span class=hljs-number >1</span>,ix+<span class=hljs-number >1</span>] = sin(<span class=hljs-number >2</span>*<span class=hljs-literal >π</span>*f*t[ix]); <span class=hljs-comment ># Calculate the next input value</span>
    xdot = dxdt(x_sim[:,ix], ui[<span class=hljs-number >1</span>,ix+<span class=hljs-number >1</span>], t[ix]); <span class=hljs-comment ># Grab the derivative vector</span>
    x_sim[:, ix+<span class=hljs-number >1</span>] = x_sim[:, ix] + xdot * dt; <span class=hljs-comment ># Integrate x</span>
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># And plot</span>
plot(t,ui[<span class=hljs-number >1</span>,:])
p = plot(t,x_sim[<span class=hljs-number >1</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$x\$&quot;</span>)
plot!(p, t,x_sim[<span class=hljs-number >2</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$\\dot{x}\$&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex3_plot.svg" alt=""></p> <h2 id=part_ii_modeling_simulating_real-world_systems ><a href="#part_ii_modeling_simulating_real-world_systems">PART II: MODELING &amp; SIMULATING REAL-WORLD SYSTEMS.</a></h2> <h3 id=model_1_satellite_attitude ><a href="#model_1_satellite_attitude"><strong>Model 1. Satellite Attitude</strong></a></h3> <p>We wish to model the 2-D attitude of a space satellite body. The 2-D satellite body can be modeled as a rigid-body mass with a moment of inertia <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>, rotating about its center of gravity <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>C.G.</mtext></mrow><annotation encoding="application/x-tex">\text{C.G.}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class=mord >C.G.</span></span></span></span></span> If we neglect the reaction moment from the satellite solar panels attached to the body, the remaining forces acting on the satellite are the thrust forces from the on-board gas thrusters in addition to disturbances that can be modeled as a moment <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">M_{D}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, as shown on Figure 2.</p> <center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_1/media/Satellite_Attitude_2D.svg" style="max-width:600px"></center> <p><strong> <center>Figure 2 - Space Satellite Body 2-D Attitude Model</center></strong></p> <p><strong> <span style='color:green'>EXERCISE 4</span></strong></p> <p>Given <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>2</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">d = 2m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span><span class="mord mathnormal">m</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>3.5</mn><mi>k</mi><mi>g</mi><mo>⋅</mo><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">I = 3.5kg \cdot m^{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >3</span><span class=mord >.</span><span class=mord >5</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p> <p>Derive the equation of motion for the satellite body shown, then derive the transfer function relating the resultant thrust force <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>R</mi></msub><mo>=</mo><msub><mi>F</mi><mn>1</mn></msub><mo>−</mo><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_{R} = F_{1} - F_{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to the angular position of the body <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>, that is, find <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo><mo>=</mo><mstyle displaystyle=true  scriptlevel=0 ><mfrac><mrow><mi mathvariant=normal >Θ</mi><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow><mrow><msub><mi>F</mi><mi>R</mi></msub><mo stretchy=false >(</mo><mi>s</mi><mo stretchy=false >)</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">G( s ) = \dfrac{\Theta( s )}{F_{R}( s )}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >Θ</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. Neglect <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">M_{D}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Given the system equation of motion, simulate the response to the following inputs, assuming <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>D</mi></msub><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">M_{D}(t) = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>. Simulate the response using basic numerical integration.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo>=</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.3599999999999999em  columnalign="left left" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>&lt;</mo><mn>2</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>2</mn><mi>s</mi><mo>≤</mo><mi>t</mi><mo>&lt;</mo><mn>4</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>4</mn><mi>s</mi><mo>≤</mo><mi>t</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">F_1 = \begin{cases} 0 &amp; 0 &lt; t &lt; 2s \\ 2 &amp; 2s \leq t &lt; 4s \\ 0 &amp; 4s \leq t \end{cases}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.35002em;"><span style="top:-2.19999em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.19499em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30501em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60002em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.41em;"><span style="top:-4.41em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span></span></span><span style="top:-2.97em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-1.5300000000000002em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.9099999999999997em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:1em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.41em;"><span style="top:-4.41em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >2</span><span class="mord mathnormal">s</span></span></span><span style="top:-2.97em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >4</span><span class="mord mathnormal">s</span></span></span><span style="top:-1.5300000000000002em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >4</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub><mo>=</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.3599999999999999em  columnalign="left left" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>&lt;</mo><mn>4</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>4</mn><mi>s</mi><mo>≤</mo><mi>t</mi><mo>&lt;</mo><mn>6</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>6</mn><mi>s</mi><mo>≤</mo><mi>t</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">F_2 = \begin{cases} 0 &amp; 0 &lt; t &lt; 4s \\ 2 &amp; 4s \leq t &lt; 6s \\ 0 &amp; 6s \leq t \end{cases}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:4.32em;vertical-align:-1.9099999999999997em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.35002em;"><span style="top:-2.19999em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.19499em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.20499em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.2950099999999996em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30501em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60002em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.41em;"><span style="top:-4.41em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span></span></span><span style="top:-2.97em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-1.5300000000000002em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.9099999999999997em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:1em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.41em;"><span style="top:-4.41em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >4</span><span class="mord mathnormal">s</span></span></span><span style="top:-2.97em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >4</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >6</span><span class="mord mathnormal">s</span></span></span><span style="top:-1.5300000000000002em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >6</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.9099999999999997em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> </p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 4</span>

<span class=hljs-comment ># Initial Conditions</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>]; 
<span class=hljs-keyword >function</span> dxdt(x,u,t)
    I = <span class=hljs-number >3.5</span>; d = <span class=hljs-number >2</span>;
    dx = [<span class=hljs-number >0.0</span>; <span class=hljs-number >0.0</span>]
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = u*d/I;
    <span class=hljs-keyword >return</span> dx
<span class=hljs-keyword >end</span>
dt = <span class=hljs-number >0.01</span>;
<span class=hljs-comment >#  Time vector</span>
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >20</span>;
 
<span class=hljs-comment ># Initialize x</span>
x_sim = zeros(<span class=hljs-number >2</span>,length(t)); <span class=hljs-comment ># Empty 2xn array</span>

<span class=hljs-keyword >function</span> us(t)
    <span class=hljs-keyword >if</span> t &gt; <span class=hljs-number >2</span> &amp;&amp; t &lt;= <span class=hljs-number >4</span>
        <span class=hljs-keyword >return</span> <span class=hljs-number >2</span>
    <span class=hljs-keyword >elseif</span> t &gt; <span class=hljs-number >4</span> &amp;&amp; t &lt;= <span class=hljs-number >6</span> 
        <span class=hljs-keyword >return</span> -<span class=hljs-number >2</span>
    <span class=hljs-keyword >else</span>
        <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

x_sim[:,<span class=hljs-number >1</span>] = x0;
 
<span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:length(t)-<span class=hljs-number >1</span>
    xdot = dxdt(x_sim[:,ix], us(t[ix]), t[ix]); <span class=hljs-comment ># Grab the derivative vector</span>
    x_sim[:, ix+<span class=hljs-number >1</span>] = x_sim[:, ix] + xdot * dt; <span class=hljs-comment ># Integrate x</span>
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># And plot</span>
p = plot(t,us.(t), lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;M&quot;</span>)
plot!(t,x_sim[<span class=hljs-number >1</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$θ\$&quot;</span>)
plot!(p, t,x_sim[<span class=hljs-number >2</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$\\dot{θ}\$&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex4_plot.svg" alt=""></p> <p>The thruster input function above is termed a bang-bang command. The idea is to apply an equal but opposite set of moments in order to roll the satellite body over a defined angle. The gas thrusters can only act in one direction, so a pair is needed to move-then-stop. This input is termed an open-loop input, meaning it doesn&#39;t consider the actual response in the system &#40;it&#39;s blind toward the system&#39;s actual response&#41;. In reality it&#39;s quite impossible to control a satellite body in this fashion, we will need to employ a feedback controller to provide just the right amount of thruster force to perform a rotation. Next we will see the effect of adding just a tiny amount of disturbance noise to the model.</p> <p>Repeat the simulation but this time assume that the disturbance moment is modeled as a zero-mean Gaussian noise with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0.005</mn></mrow><annotation encoding="application/x-tex">\sigma = 0.005</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >0</span><span class=mord >5</span></span></span></span>. Hint: to generate this random noise value use: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>∗</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>n</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\sigma*randn( 1 )</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span></span></span></span></p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 4.2</span>
<span class=hljs-keyword >function</span> dxdt(x,u,t)
    I = <span class=hljs-number >3.5</span>; d = <span class=hljs-number >2</span>;
    dx = [<span class=hljs-number >0.0</span>; <span class=hljs-number >0.0</span>]
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (u + <span class=hljs-number >0.05</span> * randn(<span class=hljs-number >1</span>)[<span class=hljs-number >1</span>]) *d/I;
    <span class=hljs-keyword >return</span> dx
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># Initialize x</span>
x_sim = zeros(<span class=hljs-number >2</span>,length(t)); <span class=hljs-comment ># Empty 2xn array</span>
x_sim[:,<span class=hljs-number >1</span>] = x0;
 
<span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:length(t)-<span class=hljs-number >1</span>
    xdot = dxdt(x_sim[:,ix], us(t[ix]), t[ix]); <span class=hljs-comment ># Grab the derivative vector</span>
    x_sim[:, ix+<span class=hljs-number >1</span>] = x_sim[:, ix] + xdot * dt; <span class=hljs-comment ># Integrate x</span>
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># And plot</span>
p = plot(t,us.(t), lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;M&quot;</span>)
plot!(t,x_sim[<span class=hljs-number >1</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$θ\$&quot;</span>)
plot!(p, t,x_sim[<span class=hljs-number >2</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$\\dot{θ}\$&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex4_2_plot.svg" alt=""></p> <h3 id=model_2_simple_pendulum ><a href="#model_2_simple_pendulum"><strong>Model 2. Simple Pendulum</strong></a></h3> <p>A simple pendulum from a uniform slender rod is shown on Figure 3. <center><img src="/me417/assets/numerical_lessons_matlab/Numerical_Lesson_1/media/SimplePendulum.svg" style="max-width:300px"></center> <strong> <center>Figure 3 - Pendulum</center></strong></p> <p>The equation of motion for the pendulum is given as</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mover accent=true ><mi>θ</mi><mo>¨</mo></mover><mo stretchy=false >(</mo><mi>I</mi><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><msup><mi>l</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mo>+</mo><mi>b</mi><mover accent=true ><mi>θ</mi><mo>˙</mo></mover><mo>+</mo><msub><mi>m</mi><mi>r</mi></msub><mi>g</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">\ddot{\theta}( I + m_{r}l^{2} ) + b\dot{\theta} + m_{r}glsin\theta = M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1813em;vertical-align:-0.25em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.16666em;"><span class=mord >¨</span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.01463em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span> <p>Where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> is the torque applied at the pivot, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">m_{r}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the mass of the rod, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span> is the rod&#39;s moment of inertia about its center of mass, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> is the distance from the pivot to the center of mass of the rod, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> is the rotational damping coefficient at the hinge and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> is the gravity constant</p> <p>Note that the above equations are nonlinear due to the presence of the trigonometric term <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sinθ</mtext></mrow><annotation encoding="application/x-tex">\text{sinθ}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class="mord text"><span class=mord >sinθ</span></span></span></span></span></p> <p><strong> <span style='color:green'>EXERCISE 5</span></strong></p> <p>Given the following parameters:</p> <table><tr><th align=right >Parameter<th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">m_{r}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span><tr><td align=right >Value<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mtext>kg</mtext></mrow><annotation encoding="application/x-tex">3\text{kg}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >3</span><span class="mord text"><span class=mord >kg</span></span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.01</mn><mi>N</mi><mo>⋅</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">0.01 N \cdot s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >1</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>19</mn><mtext>cm</mtext></mrow><annotation encoding="application/x-tex">19\text{cm}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >9</span><span class="mord text"><span class=mord >cm</span></span></span></span></span></table> <p>Simulate the response of the above nonlinear system given the following input function and plot the following responses: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\theta,\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span>. Simulate using basic numerical integration. If the response is unstable &#40;grows out of bounds&#41; try to reduce the integration time step <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >Δ</span><span class="mord mathnormal">t</span></span></span></span></p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.3599999999999999em  columnalign="left left" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>5</mn><mi>N</mi><mo>⋅</mo><mi>m</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>0</mn><mo>&lt;</mo><mi>t</mi><mo>&lt;</mo><mn>3</mn><mi>s</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mn>3</mn><mi>s</mi><mo>≤</mo><mi>t</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">M = \begin{cases} 5N \cdot m &amp; 0 &lt; t &lt; 3s \\ 0 &amp; 3s \leq t \end{cases}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class=mord ><span class=mtable ><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.69em;"><span style="top:-3.69em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >5</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">m</span></span></span><span style="top:-2.25em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.19em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:1em;"></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.69em;"><span style="top:-3.69em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >3</span><span class="mord mathnormal">s</span></span></span><span style="top:-2.25em;"><span class=pstrut  style="height:3.008em;"></span><span class=mord ><span class=mord >3</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">t</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 5</span>
<span class=hljs-keyword >function</span> dxdt(x,u,t)
    mr = <span class=hljs-number >3</span>; l = <span class=hljs-number >.19</span>; g = <span class=hljs-number >9.81</span>; ; b = <span class=hljs-number >0.1</span>;
    I = <span class=hljs-number >4</span>/<span class=hljs-number >3</span>*mr*l^<span class=hljs-number >2</span>; 
    dx = [<span class=hljs-number >0.0</span>; <span class=hljs-number >0.0</span>]
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (u - mr * g * l * sin(x[<span class=hljs-number >1</span>]) - b * x[<span class=hljs-number >2</span>] ) / (I + mr * l^<span class=hljs-number >2</span>);
    <span class=hljs-keyword >return</span> dx
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># Initialize x</span>
x0 = [<span class=hljs-number >0</span>; <span class=hljs-number >0</span>]
dt = <span class=hljs-number >0.01</span>;
t = <span class=hljs-number >0</span>:dt:<span class=hljs-number >40</span>;
x_sim = zeros(<span class=hljs-number >2</span>,length(t)); <span class=hljs-comment ># Empty 2xn array</span>
x_sim[:,<span class=hljs-number >1</span>] = x0;
 
<span class=hljs-keyword >function</span> up(t)
    <span class=hljs-keyword >if</span> t &lt; <span class=hljs-number >3</span>
        <span class=hljs-keyword >return</span> <span class=hljs-number >5</span>
    <span class=hljs-keyword >else</span>
        <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:length(t)-<span class=hljs-number >1</span>
    xdot = dxdt(x_sim[:,ix], up(t[ix]), t[ix]); <span class=hljs-comment ># Grab the derivative vector</span>
    x_sim[:, ix+<span class=hljs-number >1</span>] = x_sim[:, ix] + xdot * dt; <span class=hljs-comment ># Integrate x</span>
<span class=hljs-keyword >end</span>
 
<span class=hljs-comment ># And plot</span>
p = plot(t,up.(t), lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;M&quot;</span>)
plot!(t,x_sim[<span class=hljs-number >1</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$θ\$&quot;</span>)
plot!(p, t,x_sim[<span class=hljs-number >2</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$\\dot{θ}\$&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex5_plot.svg" alt=""></p> <p>In order to design a controller for this system using the tools we introduce in this course; the system must be linearized. In this case we can linearize the system using the small angle approximation assumption. We can do this because we generally intend to keep &#40;control&#41; the inverted pendulum close to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>≈</mo><msup><mn>0</mn><mi>o</mi></msup></mrow><annotation encoding="application/x-tex">\theta \approx 0^{o}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.664392em;vertical-align:0em;"></span><span class=mord ><span class=mord >0</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span></span></span></span></span></span></span></span></span></span></span></span>.</p> <p>Linearize the above equations using the small angle approximation. That is, assume <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">sin\theta = \theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>.</p> <p>Repeat task ‎1 using the linearized model and compare the nonlinear versus the nonlinear responses, in two subplots, one for each of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo separator=true >,</mo><mover accent=true ><mi>θ</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\theta,\dot{\theta}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.12574em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9313em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.26344em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span>. Briefly explain the observed differences. At what value of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> does the approximation become noticeably inaccurate?</p> <p><pre><code class="julia hljs"><span class=hljs-comment ># Exercise 5.2</span>

<span class=hljs-keyword >function</span> dxdt_linear(x,u,t)
    mr = <span class=hljs-number >3</span>; l = <span class=hljs-number >.19</span>; g = <span class=hljs-number >9.81</span>; b = <span class=hljs-number >0.1</span>;
    I = <span class=hljs-number >4</span>/<span class=hljs-number >3</span>*mr*l^<span class=hljs-number >2</span>; 
    dx = [<span class=hljs-number >0.0</span>; <span class=hljs-number >0.0</span>]
    dx[<span class=hljs-number >1</span>] = x[<span class=hljs-number >2</span>];
    dx[<span class=hljs-number >2</span>] = (u - mr * g * l *x[<span class=hljs-number >1</span>] - b*x[<span class=hljs-number >2</span>]) / (I + mr * l^<span class=hljs-number >2</span>);
    <span class=hljs-keyword >return</span> dx
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># Initialize x</span>
x_sim = zeros(<span class=hljs-number >2</span>,length(t)); <span class=hljs-comment ># Empty 2xn array</span>
x_sim[:,<span class=hljs-number >1</span>] = x0;
 
<span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:length(t)-<span class=hljs-number >1</span>
    xdot = dxdt_linear(x_sim[:,ix], up(t[ix]), t[ix]); <span class=hljs-comment ># Grab the derivative vector</span>
    x_sim[:, ix+<span class=hljs-number >1</span>] = x_sim[:, ix] + xdot * dt; <span class=hljs-comment ># Integrate x</span>
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># And plot</span>
p = plot(t,up.(t), lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;M&quot;</span>)
plot!(t,x_sim[<span class=hljs-number >1</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$θ\$&quot;</span>)
plot!(p, t,x_sim[<span class=hljs-number >2</span>,:], lw=<span class=hljs-number >3</span>, label = <span class=hljs-string >&quot;\$\\dot{θ}\$&quot;</span>)</code></pre> <img src="/me417/assets/numerical_lessons_julia/Numerical_Lesson_1/code/output/ex5_2_plot.svg" alt=""></p> <p>Note that when experimenting with a controller design via simulation, we design the controller using the linearized model if we wish, but it is important to simulate the response as accurate as possible. That is, simulate the nonlinear response. _ Explain why it is better to simulate the nonlinear model and not the linearized model, when testing a controller?</p> <div class=page-foot > <div class=copyright > &copy; Ali AlSaibie, PhD. Last modified: December 10, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div>